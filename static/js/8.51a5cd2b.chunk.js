(this.webpackJsonppms=this.webpackJsonppms||[]).push([[8],{385:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(386),l=a.n(c);function o(e,t){for(var a=[],n=0;n<e;n++){var c=r.a.createElement("div",{key:n,className:"".concat(l.a.block," ").concat(t)});a.push(c)}return a}t.a=function(e){return r.a.createElement("div",{className:l.a.container},o(e.todo,l.a.todo),o(e.doing,l.a.doing),o(e.done,l.a.done))}},386:function(e,t,a){e.exports={container:"_3U1Y55kCNk9Nf0cyrnE5dA",block:"_3EpNt1oR5bU4tQbOC3wv-q",todo:"_12kVQ7M2l2de7nC5Zjgp0M",doing:"_3A8b2Ti3cGKbsJeL7IEAM",done:"SvILxQULxCn3hY2IlpBFW"}},394:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));a(28);function n(e){var t={todo:[],doing:[],done:[]};return Array.isArray(e)&&e.forEach((function(e){t[e.status].push(e)})),t}var r={todo:{color:"#4a9ff9",display:"\u672a\u5f00\u59cb"},doing:{color:"#f9944a",display:"\u8fdb\u884c\u4e2d"},done:{color:"#2ac06d",display:"\u5df2\u5b8c\u6210"}}},395:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(7),r=a(2),c=a(31),l=a(0),o=a.n(l),i=a(666),s=a(660),u=a(347),d=a(109),m=a(350),f=a(677),b=i.a.Column;function E(e){var t=e.data,a=e.status,n=e.size,r=void 0===n?"default":n,c=e.onItemEditClick,l=e.editable,E=void 0===l||l;return o.a.createElement(i.a,{dataSource:t,pagination:!1,rowKey:"_id",size:r},o.a.createElement(b,{width:"90px",title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){var t=a[e];return o.a.createElement(s.a,{color:t.color},t.display)}}),o.a.createElement(b,{title:"\u5185\u5bb9",dataIndex:"content",key:"content"}),o.a.createElement(b,{title:"\u53c2\u4e0e\u8005",dataIndex:"users",key:"users",render:function(e){return o.a.createElement(u.a.Group,null,e.map((function(e){return o.a.createElement(d.a,{key:e._id,title:e.username,placement:"top"},o.a.createElement(u.a,{style:{backgroundColor:e.avatar},icon:o.a.createElement(m.a,null)}))})))}}),o.a.createElement(b,{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"createDate"}),o.a.createElement(b,{title:"\u5f00\u59cb\u65e5\u671f",dataIndex:"startDate"}),o.a.createElement(b,{title:"\u5b8c\u6210\u65e5\u671f",dataIndex:"endDate"}),E?o.a.createElement(b,{title:"\u64cd\u4f5c",dataIndex:"_id",key:"action",render:function(e,t){return o.a.createElement("a",{onClick:function(e){e.preventDefault(),c(t)}},o.a.createElement(f.a,null))}}):null)}var p=a(490),v=a(345),O=a(346),h=a(349),j=a(492),y=a(665),g=a(190),k=a.n(g),x=p.a.Option;function C(e){var t=e.visible,a=e.onOk,n=e.onCancel,i=e.task,s=e.users,d=Object(l.useState)(),f=Object(c.a)(d,2),b=f[0],E=f[1],g=v.a.useForm(),C=Object(c.a)(g,1)[0];return Object(l.useEffect)((function(){if(i){E(i.status);var e=i.startDate?k()(i.startDate):k()(),t=i.endDate?k()(i.endDate):k()(),a=i.users.map((function(e){return e._id}));C.setFieldsValue(Object(r.a)(Object(r.a)({},i),{},{selectedUsers:a,startDate:e,endDate:t}))}else C.resetFields()}),[i]),o.a.createElement(O.a,{forceRender:!0,title:"\u7f16\u8f91\u4efb\u52a1",width:640,visible:t,onOk:function(){C.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},o.a.createElement(v.a,{form:C,labelCol:{span:5},wrapperCol:{span:16}},o.a.createElement(v.a.Item,{name:"selectedUsers",label:"\u53c2\u4e0e\u8005",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u53c2\u4e0e\u8005\uff01"}]},o.a.createElement(p.a,{showSearch:!0,placeholder:"\u9009\u62e9\u53c2\u4e0e\u8005",optionFilterProp:"title",optionLabelProp:"title",mode:"multiple"},s.map((function(e,t){return o.a.createElement(x,{key:t,value:e._id,title:e.username},o.a.createElement(h.b,null,o.a.createElement(u.a,{style:{backgroundColor:e.avatar},icon:o.a.createElement(m.a,null)}),o.a.createElement("div",null,o.a.createElement("a",null," ",e.username),o.a.createElement("div",{style:{color:"rgba(0,0,0,.45)"}},e.email))))})))),o.a.createElement(v.a.Item,{name:"status",label:"\u72b6\u6001"},o.a.createElement(j.a.Group,{name:"radiogroup",onChange:function(e){E(e.target.value)}},o.a.createElement(j.a,{value:"todo"},"\u672a\u5f00\u59cb"),o.a.createElement(j.a,{value:"doing"},"\u8fdb\u884c\u4e2d"),o.a.createElement(j.a,{value:"done"},"\u5df2\u5b8c\u6210"))),"todo"!==b?o.a.createElement(v.a.Item,{name:"startDate",label:"\u5f00\u59cb\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65e5\u671f\uff01"}]},o.a.createElement(y.a,null)):null,"done"===b?o.a.createElement(v.a.Item,{name:"endDate",label:"\u5b8c\u6210\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5b8c\u6210\u65e5\u671f\uff01"}]},o.a.createElement(y.a,null)):null))}var D=a(75);function I(e){var t=Object(l.useState)(!1),a=Object(c.a)(t,2),i=a[0],s=a[1],u=Object(l.useState)({users:[]}),d=Object(c.a)(u,2),m=d[0],f=d[1],b=Object(l.useState)([]),p=Object(c.a)(b,2),v=p[0],O=p[1],h=Object(l.useState)(),j=Object(c.a)(h,2),y=j[0],g=j[1];return Object(l.useEffect)((function(){Object(D.i)().then((function(e){var t=e.data;0===t.code&&O(t.data)}))}),[]),Object(l.useEffect)((function(){g(e.data)}),[e.data]),o.a.createElement(o.a.Fragment,null,o.a.createElement(E,Object.assign({},e,{data:y,onItemEditClick:function(e){s(!0),f(e)}})),o.a.createElement(C,{visible:i,onOk:function(t){t.startDate=t.startDate?t.startDate.format("YYYY-MM-DD"):null,t.endDate=t.endDate?t.endDate.format("YYYY-MM-DD"):null,t.users=v.filter((function(e){return-1!==t.selectedUsers.indexOf(e._id)}));var a=m._id;Object(D.g)(Object(r.a)(Object(r.a)({},m),t)).then((function(t){var n=t.data;if(0===n.code){var r=y.map((function(e){return e._id===a?n.data:e}));e.updateTasks(r),s(!1)}}))},onCancel:function(){s(!1)},task:m,users:[].concat(Object(n.a)(m.users),Object(n.a)(v))}))}},430:function(e,t,a){"use strict";var n=a(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},c=a(23),l=function(e,t){return n.createElement(c.a,Object.assign({},e,{ref:t,icon:r}))};l.displayName="PlusCircleOutlined";t.a=n.forwardRef(l)},669:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));var n=a(7),r=a(2),c=a(31),l=a(0),o=a.n(l),i=a(666),s=a(667),u=a(660),d=a(1),m=a.n(d),f=a(3),b=a.n(f),E=a(4),p=a.n(E),v=a(57),O=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a},h=function(e){return l.createElement(v.a,null,(function(t){var a,n=t.getPrefixCls,r=t.direction,c=e.prefixCls,o=e.type,i=void 0===o?"horizontal":o,s=e.orientation,u=void 0===s?"center":s,d=e.className,f=e.children,E=e.dashed,v=e.plain,h=O(e,["prefixCls","type","orientation","className","children","dashed","plain"]),j=n("divider",c),y=u.length>0?"-".concat(u):u,g=!!f,k=p()(j,"".concat(j,"-").concat(i),(a={},b()(a,"".concat(j,"-with-text"),g),b()(a,"".concat(j,"-with-text").concat(y),g),b()(a,"".concat(j,"-dashed"),!!E),b()(a,"".concat(j,"-plain"),!!v),b()(a,"".concat(j,"-rtl"),"rtl"===r),a),d);return l.createElement("div",m()({className:k},h,{role:"separator"}),f&&l.createElement("span",{className:"".concat(j,"-inner-text")},f))}))},j=a(72),y=a(430),g=a(677),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"fork",theme:"outlined"},x=a(23),C=function(e,t){return l.createElement(x.a,Object.assign({},e,{ref:t,icon:k}))};C.displayName="ForkOutlined";var D=l.forwardRef(C),I=a(385),w=a(345),_=a(346),Y=a(343),S=a(665),F=a(190),M=a.n(F);function z(e){var t=e.visible,a=e.onOk,n=e.onCancel,r=w.a.useForm(),l=Object(c.a)(r,1)[0];return o.a.createElement(_.a,{forceRender:!0,title:"\u65b0\u589e\u4efb\u52a1",width:640,visible:t,onOk:function(){l.validateFields().then((function(e){a(e),l.resetFields()})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},o.a.createElement(w.a,{initialValues:{createDate:M()()},form:l,labelCol:{span:5},wrapperCol:{span:16}},o.a.createElement(w.a.Item,{name:"content",label:"\u4efb\u52a1\u5185\u5bb9",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u4efb\u52a1\u5185\u5bb9\uff01",min:5}]},o.a.createElement(Y.a.TextArea,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),o.a.createElement(w.a.Item,{name:"createDate",label:"\u521b\u5efa\u65e5\u671f"},o.a.createElement(S.a,null))))}var N=a(492);function T(e){var t=e.visible,a=e.onOk,n=e.onCancel,i=e.story,s=w.a.useForm(),u=Object(c.a)(s,1)[0];return Object(l.useEffect)((function(){if(i){var e=M()(i.date);u.setFieldsValue(Object(r.a)(Object(r.a)({},i),{},{date:e}))}else u.resetFields()})),o.a.createElement(_.a,{forceRender:!0,title:i?"\u7f16\u8f91\u9700\u6c42":"\u65b0\u589e\u9700\u6c42",width:640,visible:t,onOk:function(){u.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},o.a.createElement(w.a,{initialValues:{date:M()(),priority:0},form:u,labelCol:{span:5},wrapperCol:{span:16}},o.a.createElement(w.a.Item,{name:"role",label:"\u89d2\u8272",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\uff01"}]},o.a.createElement(Y.a,{placeholder:"\u8bf7\u8f93\u5165"})),o.a.createElement(w.a.Item,{name:"activity",label:"\u884c\u4e3a",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\uff01",min:5}]},o.a.createElement(Y.a.TextArea,{rows:2,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),o.a.createElement(w.a.Item,{name:"businessValue",label:"\u76ee\u7684",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\uff01",min:5}]},o.a.createElement(Y.a.TextArea,{rows:2,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),o.a.createElement(w.a.Item,{name:"date",label:"\u63d0\u51fa\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63d0\u51fa\u65e5\u671f\uff01"}]},o.a.createElement(S.a,null)),o.a.createElement(w.a.Item,{name:"priority",label:"\u4f18\u5148\u7ea7"},o.a.createElement(N.a.Group,{name:"radiogroup"},o.a.createElement(N.a,{value:0},"\u4f4e"),o.a.createElement(N.a,{value:1},"\u4e2d"),o.a.createElement(N.a,{value:2},"\u9ad8")))))}var V=a(395),q=a(75),A=a(394),R=i.a.Column,P=[{color:"#2ac06d",display:"\u4f4e"},{color:"#f9944a",display:"\u4e2d"},{color:"#ff4d4f",display:"\u9ad8"}];function L(e){var t=Object(l.useState)(!1),a=Object(c.a)(t,2),d=a[0],m=a[1],f=Object(l.useState)(!1),b=Object(c.a)(f,2),E=b[0],p=b[1],v=Object(l.useState)(null),O=Object(c.a)(v,2),k=O[0],x=O[1],C=Object(l.useState)([]),w=Object(c.a)(C,2),_=w[0],Y=w[1];Object(l.useEffect)((function(){Object(q.n)().then((function(e){var t=e.data;0===t.code&&(t.data.forEach((function(e){var t=e.tasks;e.tasks=Object(A.a)(t)})),Y(t.data))}))}),[]);var S=function(e){m(!0),x(e)};return o.a.createElement("div",null,o.a.createElement(s.a,{title:"\u9879\u76ee\u9700\u6c42",extra:o.a.createElement("a",{onClick:function(e){e.preventDefault(),S()}},o.a.createElement(y.a,{style:{fontSize:"24px"}}))},o.a.createElement(i.a,{dataSource:_,pagination:!1,rowKey:"_id",expandable:{expandedRowRender:function(e){var t=Object.values(e.tasks).flat();return o.a.createElement(V.a,{data:t,status:A.b,size:"small",editable:!1})},rowExpandable:function(e){return Object.values(e.tasks).flat().length>0}}},o.a.createElement(R,{width:"80px",title:"\u4f18\u5148\u7ea7",dataIndex:"priority",key:"priority",render:function(e){var t=P[e];return o.a.createElement(u.a,{style:{width:"40px",textAlign:"center"},color:t.color},t.display)}}),o.a.createElement(R,{title:"\u89d2\u8272",dataIndex:"role",key:"role"}),o.a.createElement(R,{title:"\u884c\u4e3a",dataIndex:"activity",key:"activity"}),o.a.createElement(R,{title:"\u76ee\u7684",dataIndex:"businessValue",key:"businessValue",progress:!0}),o.a.createElement(R,{title:"\u4efb\u52a1\u8fdb\u5ea6",dataIndex:"_id",render:function(e,t){return o.a.createElement(j.b,{to:"/project/board/story/".concat(e)},o.a.createElement(I.a,{todo:t.tasks.todo.length,doing:t.tasks.doing.length,done:t.tasks.done.length}))}}),o.a.createElement(R,{title:"\u63d0\u51fa\u65e5\u671f",dataIndex:"date",key:"date"}),o.a.createElement(R,{title:"\u64cd\u4f5c",key:"_id",render:function(e,t){return o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{onClick:function(){return S(t)}},o.a.createElement(g.a,null)),o.a.createElement(h,{type:"vertical"}),o.a.createElement("a",{onClick:function(){return function(e){p(!0),x(e)}(t)}},o.a.createElement(D,null)))}}))),o.a.createElement(z,{visible:E,onOk:function(e){e.createDate=e.createDate.format("YYYY-MM-DD"),Object(q.d)(e).then((function(e){var t=e.data;if(0===t.code){var a=_.map((function(e){return e._id===k._id&&e.tasks.todo.push(t.data),e}));Y(a),p(!1)}}))},onCancel:function(e){p(!1)}}),o.a.createElement(T,{visible:d,onOk:function(e){var t=k?k._id:"";e.date=e.date.format("YYYY-MM-DD"),t?Object(q.f)(Object(r.a)(Object(r.a)({},e),{},{_id:t})).then((function(e){var a=e.data;if(0===a.code){var n=_.map((function(e){return e._id===t?Object(r.a)(Object(r.a)({},e),a.data):e}));Y(n),m(!1)}})):Object(q.c)(e).then((function(e){var t=e.data;0===t.code&&(Y([t.data].concat(Object(n.a)(_))),m(!1))}))},onCancel:function(e){m(!1)},story:k}))}}}]);
//# sourceMappingURL=8.51a5cd2b.chunk.js.map