{"version":3,"sources":["components/task-progress/task-progress.jsx","components/task-progress/task-progress.module.less","utils/index.js","components/task/list.jsx","components/task/edit-modal.jsx","containers/project/task/task.jsx","../node_modules/@ant-design/icons-svg/es/asn/PlusCircleOutlined.js","../node_modules/@ant-design/icons/es/icons/PlusCircleOutlined.js","../node_modules/antd/es/divider/index.js","../node_modules/@ant-design/icons-svg/es/asn/ForkOutlined.js","../node_modules/@ant-design/icons/es/icons/ForkOutlined.js","components/task/add-modal.jsx","components/story/modal.jsx","containers/project/story/story.jsx"],"names":["genChildren","num","className","children","index","element","key","styles","block","push","TaskProgress","props","container","todo","doing","done","module","exports","sortTasks","tasks","sortedTasks","Array","isArray","forEach","task","status","color","display","Column","Table","List","data","size","onItemEditClick","editable","dataSource","pagination","rowKey","width","title","dataIndex","render","value","p","users","Group","map","user","_id","username","placement","style","backgroundColor","avatar","icon","UserOutlined","record","onClick","e","preventDefault","EditOutlined","Option","Select","StoryModal","visible","onOk","onCancel","useState","setStatus","Form","useForm","form","useEffect","startDate","moment","endDate","selectedUsers","setFieldsValue","resetFields","forceRender","validateFields","then","values","catch","info","console","log","okText","cancelText","labelCol","span","wrapperCol","Item","name","label","rules","required","message","showSearch","placeholder","optionFilterProp","optionLabelProp","mode","email","onChange","target","Task","setVisible","setTask","setUsers","setData","reqMemberList","res","result","code","format","filter","indexOf","reqEditTask","taskList","updateTasks","PlusCircleOutlined","ref","React","AntdIcon","Object","assign","PlusCircleOutlinedSvg","displayName","__rest","s","t","prototype","hasOwnProperty","call","getOwnPropertySymbols","i","length","propertyIsEnumerable","Divider","ConfigConsumer","_ref","_classNames","getPrefixCls","direction","customizePrefixCls","prefixCls","_props$type","type","_props$orientation","orientation","dashed","plain","restProps","orientationPrefix","concat","hasChildren","classString","classNames","_defineProperty","_extends","role","ForkOutlined","ForkOutlinedSvg","TaskModal","initialValues","createDate","min","TextArea","rows","story","date","priority","Story","storyModalVisible","setStoryModalVisible","taskModalVisible","setTaskModalVisible","current","setCurrent","storyList","setStoryList","reqStoryList","showStoryModal","extra","fontSize","expandable","expandedRowRender","flat","rowExpandable","textAlign","progress","id","to","showTaskModal","reqCreateTask","newStoryList","reqEditStory","reqCreateStory"],"mappings":"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","file":"static/js/8.51a5cd2b.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport styles from './task-progress.module.less';\n\nfunction genChildren(num, className) {\n  let children = [];\n  for (let index = 0; index < num; index++) {\n    const element = (\n      <div key={index} className={`${styles.block} ${className}`}></div>\n    );\n    children.push(element);\n  }\n  return children;\n}\n\nfunction TaskProgress(props) {\n  return (\n    <div className={styles.container}>\n      {genChildren(props.todo, styles.todo)}\n      {genChildren(props.doing, styles.doing)}\n      {genChildren(props.done, styles.done)}\n    </div>\n  );\n}\n\nTaskProgress.propTypes = {\n  todo: PropTypes.number.isRequired,\n  doing: PropTypes.number.isRequired,\n  done: PropTypes.number.isRequired,\n};\n\nexport default TaskProgress;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"_3U1Y55kCNk9Nf0cyrnE5dA\",\"block\":\"_3EpNt1oR5bU4tQbOC3wv-q\",\"todo\":\"_12kVQ7M2l2de7nC5Zjgp0M\",\"doing\":\"_3A8b2Ti3cGKbsJeL7IEAM\",\"done\":\"SvILxQULxCn3hY2IlpBFW\"};","import Cookies from 'js-cookie';\nexport function getRedirectTo() {\n  const projectId = Cookies.get('projectId');\n  return projectId ? '/project/profile' : '/';\n}\n\nexport function sortTasks(tasks) {\n  let sortedTasks = {\n    todo: [],\n    doing: [],\n    done: [],\n  };\n  if (Array.isArray(tasks)) {\n    tasks.forEach((task) => {\n      sortedTasks[task.status].push(task);\n    });\n  }\n  return sortedTasks;\n}\n\nexport const status = {\n  todo: {\n    color: '#4a9ff9',\n    display: '未开始',\n  },\n  doing: {\n    color: '#f9944a',\n    display: '进行中',\n  },\n  done: {\n    color: '#2ac06d',\n    display: '已完成',\n  },\n};\n","import React from 'react';\nimport { Table, Avatar, Tooltip, Tag } from 'antd';\nimport { UserOutlined, EditOutlined } from '@ant-design/icons';\n\nconst { Column } = Table;\n\nexport default function List(props) {\n  const {\n    data,\n    status,\n    size = 'default',\n    onItemEditClick,\n    editable = true,\n  } = props;\n\n  return (\n    <Table dataSource={data} pagination={false} rowKey=\"_id\" size={size}>\n      <Column\n        width=\"90px\"\n        title=\"状态\"\n        dataIndex=\"status\"\n        key=\"status\"\n        render={(value) => {\n          const p = status[value];\n          return <Tag color={p.color}>{p.display}</Tag>;\n        }}\n      />\n      <Column title=\"内容\" dataIndex=\"content\" key=\"content\" />\n      <Column\n        title=\"参与者\"\n        dataIndex=\"users\"\n        key=\"users\"\n        render={(users) => (\n          <Avatar.Group>\n            {users.map((user) => (\n              <Tooltip key={user._id} title={user.username} placement=\"top\">\n                <Avatar\n                  style={{ backgroundColor: user.avatar }}\n                  icon={<UserOutlined />}\n                />\n              </Tooltip>\n            ))}\n          </Avatar.Group>\n        )}\n      />\n      <Column title=\"创建日期\" dataIndex=\"createDate\" />\n      <Column title=\"开始日期\" dataIndex=\"startDate\" />\n      <Column title=\"完成日期\" dataIndex=\"endDate\" />\n      {editable ? (\n        <Column\n          title=\"操作\"\n          dataIndex=\"_id\"\n          key=\"action\"\n          render={(_id, record) => (\n            <a\n              onClick={(e) => {\n                e.preventDefault();\n                onItemEditClick(record);\n              }}\n            >\n              <EditOutlined />\n            </a>\n          )}\n        />\n      ) : null}\n    </Table>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport {\n  Modal,\n  Form,\n  Input,\n  DatePicker,\n  Radio,\n  Select,\n  Avatar,\n  Space,\n} from 'antd';\nimport moment from 'moment';\nimport { UserOutlined } from '@ant-design/icons';\n\nconst { Option } = Select;\n\nexport default function StoryModal({ visible, onOk, onCancel, task, users }) {\n  const [status, setStatus] = useState();\n  const [form] = Form.useForm();\n  useEffect(() => {\n    if (task) {\n      setStatus(task.status);\n      const startDate = task.startDate ? moment(task.startDate) : moment();\n      const endDate = task.endDate ? moment(task.endDate) : moment();\n      const selectedUsers = task.users.map((user) => user._id);\n      form.setFieldsValue({\n        ...task,\n        selectedUsers,\n        startDate,\n        endDate,\n      });\n    } else {\n      form.resetFields();\n    }\n  }, [task]);\n\n  function handleChange(e) {\n    setStatus(e.target.value);\n  }\n\n  return (\n    <Modal\n      forceRender\n      title=\"编辑任务\"\n      width={640}\n      visible={visible}\n      onOk={() => {\n        form\n          .validateFields()\n          .then((values) => {\n            onOk(values);\n          })\n          .catch((info) => {\n            console.log('验证失败：', info);\n          });\n      }}\n      onCancel={onCancel}\n      okText=\"确定\"\n      cancelText=\"取消\"\n    >\n      <Form\n        form={form}\n        labelCol={{\n          span: 5,\n        }}\n        wrapperCol={{\n          span: 16,\n        }}\n      >\n        <Form.Item\n          name=\"selectedUsers\"\n          label=\"参与者\"\n          rules={[\n            {\n              required: true,\n              message: '请选择参与者！',\n            },\n          ]}\n        >\n          <Select\n            showSearch\n            placeholder=\"选择参与者\"\n            optionFilterProp=\"title\"\n            optionLabelProp=\"title\"\n            mode=\"multiple\"\n          >\n            {users.map((user, index) => (\n              <Option key={index} value={user._id} title={user.username}>\n                <Space>\n                  <Avatar\n                    style={{ backgroundColor: user.avatar }}\n                    icon={<UserOutlined />}\n                  ></Avatar>\n                  <div>\n                    <a> {user.username}</a>\n                    <div style={{ color: 'rgba(0,0,0,.45)' }}>{user.email}</div>\n                  </div>\n                </Space>\n              </Option>\n            ))}\n          </Select>\n        </Form.Item>\n\n        <Form.Item name=\"status\" label=\"状态\">\n          <Radio.Group name=\"radiogroup\" onChange={handleChange}>\n            <Radio value=\"todo\">未开始</Radio>\n            <Radio value=\"doing\">进行中</Radio>\n            <Radio value=\"done\">已完成</Radio>\n          </Radio.Group>\n        </Form.Item>\n\n        {status !== 'todo' ? (\n          <Form.Item\n            name=\"startDate\"\n            label=\"开始日期\"\n            rules={[\n              {\n                required: true,\n                message: '请选择开始日期！',\n              },\n            ]}\n          >\n            <DatePicker />\n          </Form.Item>\n        ) : null}\n        {status === 'done' ? (\n          <Form.Item\n            name=\"endDate\"\n            label=\"完成日期\"\n            rules={[\n              {\n                required: true,\n                message: '请选择完成日期！',\n              },\n            ]}\n          >\n            <DatePicker />\n          </Form.Item>\n        ) : null}\n      </Form>\n    </Modal>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport List from '../../../components/task/list';\nimport Modal from '../../../components/task/edit-modal';\nimport { reqMemberList, reqEditTask } from '../../../api/index';\n\nexport default function Task(props) {\n  const [visible, setVisible] = useState(false);\n  const [task, setTask] = useState({ users: [] });\n  const [users, setUsers] = useState([]);\n  const [data, setData] = useState();\n\n  useEffect(() => {\n    reqMemberList().then((res) => {\n      const result = res.data;\n      if (result.code === 0) {\n        setUsers(result.data);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    setData(props.data);\n  }, [props.data]);\n\n  function showModal(task) {\n    setVisible(true);\n    setTask(task);\n  }\n\n  function handleCancel() {\n    setVisible(false);\n  }\n\n  function handleOk(values) {\n    values.startDate = values.startDate\n      ? values.startDate.format('YYYY-MM-DD')\n      : null;\n    values.endDate = values.endDate\n      ? values.endDate.format('YYYY-MM-DD')\n      : null;\n    values.users = users.filter(\n      (user) => values.selectedUsers.indexOf(user._id) !== -1\n    );\n    const _id = task._id;\n    reqEditTask({ ...task, ...values }).then((res) => {\n      const result = res.data;\n      if (result.code === 0) {\n        const taskList = data.map((task) =>\n          task._id === _id ? result.data : task\n        );\n        props.updateTasks(taskList);\n        setVisible(false);\n      }\n    });\n  }\n\n  return (\n    <>\n      <List {...props} data={data} onItemEditClick={showModal}></List>\n      <Modal\n        visible={visible}\n        onOk={handleOk}\n        onCancel={handleCancel}\n        task={task}\n        users={[...task.users, ...users]}\n      ></Modal>\n    </>\n  );\n}\n","// This icon file is generated automatically.\nvar PlusCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }] }, \"name\": \"plus-circle\", \"theme\": \"outlined\" };\nexport default PlusCircleOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport PlusCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/PlusCircleOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar PlusCircleOutlined = function PlusCircleOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: PlusCircleOutlinedSvg\n  }));\n};\n\nPlusCircleOutlined.displayName = 'PlusCircleOutlined';\nexport default React.forwardRef(PlusCircleOutlined);","import _extends from \"@babel/runtime/helpers/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { ConfigConsumer } from '../config-provider';\n\nvar Divider = function Divider(props) {\n  return /*#__PURE__*/React.createElement(ConfigConsumer, null, function (_ref) {\n    var _classNames;\n\n    var getPrefixCls = _ref.getPrefixCls,\n        direction = _ref.direction;\n\n    var customizePrefixCls = props.prefixCls,\n        _props$type = props.type,\n        type = _props$type === void 0 ? 'horizontal' : _props$type,\n        _props$orientation = props.orientation,\n        orientation = _props$orientation === void 0 ? 'center' : _props$orientation,\n        className = props.className,\n        children = props.children,\n        dashed = props.dashed,\n        plain = props.plain,\n        restProps = __rest(props, [\"prefixCls\", \"type\", \"orientation\", \"className\", \"children\", \"dashed\", \"plain\"]);\n\n    var prefixCls = getPrefixCls('divider', customizePrefixCls);\n    var orientationPrefix = orientation.length > 0 ? \"-\".concat(orientation) : orientation;\n    var hasChildren = !!children;\n    var classString = classNames(prefixCls, \"\".concat(prefixCls, \"-\").concat(type), (_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixCls, \"-with-text\"), hasChildren), _defineProperty(_classNames, \"\".concat(prefixCls, \"-with-text\").concat(orientationPrefix), hasChildren), _defineProperty(_classNames, \"\".concat(prefixCls, \"-dashed\"), !!dashed), _defineProperty(_classNames, \"\".concat(prefixCls, \"-plain\"), !!plain), _defineProperty(_classNames, \"\".concat(prefixCls, \"-rtl\"), direction === 'rtl'), _classNames), className);\n    return /*#__PURE__*/React.createElement(\"div\", _extends({\n      className: classString\n    }, restProps, {\n      role: \"separator\"\n    }), children && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"\".concat(prefixCls, \"-inner-text\")\n    }, children));\n  });\n};\n\nexport default Divider;","// This icon file is generated automatically.\nvar ForkOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z\" } }] }, \"name\": \"fork\", \"theme\": \"outlined\" };\nexport default ForkOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ForkOutlinedSvg from \"@ant-design/icons-svg/es/asn/ForkOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar ForkOutlined = function ForkOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: ForkOutlinedSvg\n  }));\n};\n\nForkOutlined.displayName = 'ForkOutlined';\nexport default React.forwardRef(ForkOutlined);","import React, { useEffect } from 'react';\nimport { Modal, Form, Input, DatePicker } from 'antd';\nimport moment from 'moment';\n\nexport default function TaskModal({ visible, onOk, onCancel }) {\n  const [form] = Form.useForm();\n  //   useEffect(() => {\n  //     form.resetFields();\n  //   });\n\n  return (\n    <Modal\n      forceRender\n      title=\"新增任务\"\n      width={640}\n      visible={visible}\n      onOk={() => {\n        form\n          .validateFields()\n          .then((values) => {\n            onOk(values);\n            form.resetFields();\n          })\n          .catch((info) => {\n            console.log('验证失败：', info);\n          });\n      }}\n      onCancel={onCancel}\n      okText=\"确定\"\n      cancelText=\"取消\"\n    >\n      <Form\n        initialValues={{ createDate: moment() }}\n        form={form}\n        labelCol={{\n          span: 5,\n        }}\n        wrapperCol={{\n          span: 16,\n        }}\n      >\n        <Form.Item\n          name=\"content\"\n          label=\"任务内容\"\n          rules={[\n            {\n              required: true,\n              message: '请输入至少五个字符的任务内容！',\n              min: 5,\n            },\n          ]}\n        >\n          <Input.TextArea rows={4} placeholder=\"请输入至少五个字符\" />\n        </Form.Item>\n        <Form.Item name=\"createDate\" label=\"创建日期\">\n          <DatePicker />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n}\n","import React, { useEffect } from 'react';\nimport { Modal, Form, Input, DatePicker, Radio } from 'antd';\nimport moment from 'moment';\n\nexport default function StoryModal({ visible, onOk, onCancel, story }) {\n  const [form] = Form.useForm();\n  useEffect(() => {\n    if (story) {\n      const date = moment(story.date);\n      form.setFieldsValue({ ...story, date });\n    } else {\n      form.resetFields();\n    }\n  });\n\n  return (\n    <Modal\n      forceRender\n      title={story ? '编辑需求' : '新增需求'}\n      width={640}\n      visible={visible}\n      onOk={() => {\n        form\n          .validateFields()\n          .then((values) => {\n            onOk(values);\n          })\n          .catch((info) => {\n            console.log('验证失败：', info);\n          });\n      }}\n      onCancel={onCancel}\n      okText=\"确定\"\n      cancelText=\"取消\"\n    >\n      <Form\n        initialValues={{ date: moment(), priority: 0 }}\n        form={form}\n        labelCol={{\n          span: 5,\n        }}\n        wrapperCol={{\n          span: 16,\n        }}\n      >\n        <Form.Item\n          name=\"role\"\n          label=\"角色\"\n          rules={[\n            {\n              required: true,\n              message: '请输入角色！',\n            },\n          ]}\n        >\n          <Input placeholder=\"请输入\" />\n        </Form.Item>\n        <Form.Item\n          name=\"activity\"\n          label=\"行为\"\n          rules={[\n            {\n              required: true,\n              message: '请输入至少五个字符！',\n              min: 5,\n            },\n          ]}\n        >\n          <Input.TextArea rows={2} placeholder=\"请输入至少五个字符\" />\n        </Form.Item>\n        <Form.Item\n          name=\"businessValue\"\n          label=\"目的\"\n          rules={[\n            {\n              required: true,\n              message: '请输入至少五个字符！',\n              min: 5,\n            },\n          ]}\n        >\n          <Input.TextArea rows={2} placeholder=\"请输入至少五个字符\" />\n        </Form.Item>\n        <Form.Item\n          name=\"date\"\n          label=\"提出日期\"\n          rules={[\n            {\n              required: true,\n              message: '请选择提出日期！',\n            },\n          ]}\n        >\n          <DatePicker />\n        </Form.Item>\n        <Form.Item name=\"priority\" label=\"优先级\">\n          <Radio.Group name=\"radiogroup\">\n            <Radio value={0}>低</Radio>\n            <Radio value={1}>中</Radio>\n            <Radio value={2}>高</Radio>\n          </Radio.Group>\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n}\n","import React, { Component, useState, useEffect } from \"react\";\nimport { Card, Table, Form, DatePicker, Modal, Tag, Divider } from \"antd\";\nimport { Link } from \"react-router-dom\";\nimport {\n  EditOutlined,\n  PlusCircleOutlined,\n  ForkOutlined,\n} from \"@ant-design/icons\";\n\nimport TaskProgress from \"../../../components/task-progress/task-progress\";\nimport AddTaskModal from \"../../../components/task/add-modal\";\nimport StoryModal from \"../../../components/story/modal\";\nimport TaskList from \"../task/task\";\nimport {\n  reqCreateTask,\n  reqCreateStory,\n  reqStoryList,\n  reqEditStory,\n} from \"../../../api/index\";\n\nimport { sortTasks, status } from \"../../../utils/index\";\n\nconst { Column } = Table;\n\nconst priority = [\n  {\n    color: \"#2ac06d\",\n    display: \"低\",\n  },\n  {\n    color: \"#f9944a\",\n    display: \"中\",\n  },\n  {\n    color: \"#ff4d4f\",\n    display: \"高\",\n  },\n];\n\nexport default function Story(props) {\n  const [storyModalVisible, setStoryModalVisible] = useState(false);\n  const [taskModalVisible, setTaskModalVisible] = useState(false);\n  const [current, setCurrent] = useState(null);\n  const [storyList, setStoryList] = useState([]);\n\n  useEffect(() => {\n    reqStoryList().then((res) => {\n      const result = res.data;\n      if (result.code === 0) {\n        result.data.forEach((story) => {\n          const tasks = story.tasks;\n          story.tasks = sortTasks(tasks);\n        });\n        setStoryList(result.data);\n      }\n    });\n  }, []);\n\n  const showStoryModal = (current) => {\n    setStoryModalVisible(true);\n    setCurrent(current);\n  };\n\n  const showTaskModal = (current) => {\n    setTaskModalVisible(true);\n    setCurrent(current);\n  };\n\n  const handleStoryCancel = (e) => {\n    setStoryModalVisible(false);\n  };\n\n  const handleTaskCancel = (e) => {\n    setTaskModalVisible(false);\n  };\n\n  const handleTaskOk = (values) => {\n    values.createDate = values.createDate.format(\"YYYY-MM-DD\");\n    reqCreateTask(values).then((res) => {\n      const result = res.data;\n      if (result.code === 0) {\n        const newStoryList = storyList.map((story) => {\n          if (story._id === current._id) {\n            story.tasks.todo.push(result.data);\n          }\n          return story;\n        });\n        setStoryList(newStoryList);\n        setTaskModalVisible(false);\n      }\n    });\n  };\n\n  const handleStoryOk = (values) => {\n    const _id = current ? current._id : \"\";\n    values.date = values.date.format(\"YYYY-MM-DD\");\n\n    if (_id) {\n      //编辑\n      reqEditStory({ ...values, _id }).then((res) => {\n        const result = res.data;\n        if (result.code === 0) {\n          const newStoryList = storyList.map((story) =>\n            story._id === _id ? { ...story, ...result.data } : story\n          );\n          setStoryList(newStoryList);\n          setStoryModalVisible(false);\n        }\n      });\n    } else {\n      reqCreateStory(values).then((res) => {\n        const result = res.data;\n        if (result.code === 0) {\n          setStoryList([result.data, ...storyList]);\n          setStoryModalVisible(false);\n        }\n      });\n    }\n  };\n\n  return (\n    <div>\n      <Card\n        title=\"项目需求\"\n        extra={\n          <a\n            onClick={(e) => {\n              e.preventDefault();\n              showStoryModal();\n            }}\n          >\n            <PlusCircleOutlined style={{ fontSize: \"24px\" }} />\n          </a>\n        }\n      >\n        <Table\n          dataSource={storyList}\n          pagination={false}\n          rowKey=\"_id\"\n          expandable={{\n            expandedRowRender: (record) => {\n              const data = Object.values(record.tasks).flat();\n              return (\n                <TaskList\n                  data={data}\n                  status={status}\n                  size=\"small\"\n                  editable={false}\n                ></TaskList>\n              );\n            },\n            rowExpandable: (record) =>\n              Object.values(record.tasks).flat().length > 0,\n          }}\n        >\n          <Column\n            width=\"80px\"\n            title=\"优先级\"\n            dataIndex=\"priority\"\n            key=\"priority\"\n            render={(value) => {\n              const p = priority[value];\n              return (\n                <Tag\n                  style={{ width: \"40px\", textAlign: \"center\" }}\n                  color={p.color}\n                >\n                  {p.display}\n                </Tag>\n              );\n            }}\n          />\n          <Column title=\"角色\" dataIndex=\"role\" key=\"role\" />\n          <Column title=\"行为\" dataIndex=\"activity\" key=\"activity\" />\n          <Column\n            title=\"目的\"\n            dataIndex=\"businessValue\"\n            key=\"businessValue\"\n            progress\n          />\n\n          <Column\n            title=\"任务进度\"\n            dataIndex=\"_id\"\n            render={(id, record) => {\n              return (\n                <Link to={`/project/board/story/${id}`}>\n                  <TaskProgress\n                    todo={record.tasks.todo.length}\n                    doing={record.tasks.doing.length}\n                    done={record.tasks.done.length}\n                  />\n                </Link>\n              );\n            }}\n          />\n          <Column title=\"提出日期\" dataIndex=\"date\" key=\"date\" />\n          <Column\n            title=\"操作\"\n            key=\"_id\"\n            render={(id, record) => (\n              <>\n                <a onClick={() => showStoryModal(record)}>\n                  <EditOutlined />\n                </a>\n                <Divider type=\"vertical\" />\n                <a onClick={() => showTaskModal(record)}>\n                  <ForkOutlined />\n                </a>\n              </>\n            )}\n          />\n        </Table>\n      </Card>\n\n      <AddTaskModal\n        visible={taskModalVisible}\n        onOk={handleTaskOk}\n        onCancel={handleTaskCancel}\n      ></AddTaskModal>\n      <StoryModal\n        visible={storyModalVisible}\n        onOk={handleStoryOk}\n        onCancel={handleStoryCancel}\n        story={current}\n      ></StoryModal>\n    </div>\n  );\n}\n"],"sourceRoot":""}