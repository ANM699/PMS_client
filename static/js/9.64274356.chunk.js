(this.webpackJsonppms=this.webpackJsonppms||[]).push([[9],{394:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));a(28);function n(e){var t={todo:[],doing:[],done:[]};return Array.isArray(e)&&e.forEach((function(e){t[e.status].push(e)})),t}var r={todo:{color:"#4a9ff9",display:"\u672a\u5f00\u59cb"},doing:{color:"#f9944a",display:"\u8fdb\u884c\u4e2d"},done:{color:"#2ac06d",display:"\u5df2\u5b8c\u6210"}}},395:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(7),r=a(2),l=a(31),c=a(0),o=a.n(c),s=a(666),u=a(660),i=a(347),d=a(109),m=a(350),f=a(677),E=s.a.Column;function b(e){var t=e.data,a=e.status,n=e.size,r=void 0===n?"default":n,l=e.onItemEditClick,c=e.editable,b=void 0===c||c;return o.a.createElement(s.a,{dataSource:t,pagination:!1,rowKey:"_id",size:r},o.a.createElement(E,{width:"90px",title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){var t=a[e];return o.a.createElement(u.a,{color:t.color},t.display)}}),o.a.createElement(E,{title:"\u5185\u5bb9",dataIndex:"content",key:"content"}),o.a.createElement(E,{title:"\u53c2\u4e0e\u8005",dataIndex:"users",key:"users",render:function(e){return o.a.createElement(i.a.Group,null,e.map((function(e){return o.a.createElement(d.a,{key:e._id,title:e.username,placement:"top"},o.a.createElement(i.a,{style:{backgroundColor:e.avatar},icon:o.a.createElement(m.a,null)}))})))}}),o.a.createElement(E,{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"createDate"}),o.a.createElement(E,{title:"\u5f00\u59cb\u65e5\u671f",dataIndex:"startDate"}),o.a.createElement(E,{title:"\u5b8c\u6210\u65e5\u671f",dataIndex:"endDate"}),b?o.a.createElement(E,{title:"\u64cd\u4f5c",dataIndex:"_id",key:"action",render:function(e,t){return o.a.createElement("a",{onClick:function(e){e.preventDefault(),l(t)}},o.a.createElement(f.a,null))}}):null)}var p=a(490),v=a(345),D=a(346),O=a(349),j=a(492),g=a(665),k=a(190),y=a.n(k),h=p.a.Option;function I(e){var t=e.visible,a=e.onOk,n=e.onCancel,s=e.task,u=e.users,d=Object(c.useState)(),f=Object(l.a)(d,2),E=f[0],b=f[1],k=v.a.useForm(),I=Object(l.a)(k,1)[0];return Object(c.useEffect)((function(){if(s){b(s.status);var e=s.startDate?y()(s.startDate):y()(),t=s.endDate?y()(s.endDate):y()(),a=s.users.map((function(e){return e._id}));I.setFieldsValue(Object(r.a)(Object(r.a)({},s),{},{selectedUsers:a,startDate:e,endDate:t}))}else I.resetFields()}),[s]),o.a.createElement(D.a,{forceRender:!0,title:"\u7f16\u8f91\u4efb\u52a1",width:640,visible:t,onOk:function(){I.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},o.a.createElement(v.a,{form:I,labelCol:{span:5},wrapperCol:{span:16}},o.a.createElement(v.a.Item,{name:"selectedUsers",label:"\u53c2\u4e0e\u8005",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u53c2\u4e0e\u8005\uff01"}]},o.a.createElement(p.a,{showSearch:!0,placeholder:"\u9009\u62e9\u53c2\u4e0e\u8005",optionFilterProp:"title",optionLabelProp:"title",mode:"multiple"},u.map((function(e,t){return o.a.createElement(h,{key:t,value:e._id,title:e.username},o.a.createElement(O.b,null,o.a.createElement(i.a,{style:{backgroundColor:e.avatar},icon:o.a.createElement(m.a,null)}),o.a.createElement("div",null,o.a.createElement("a",null," ",e.username),o.a.createElement("div",{style:{color:"rgba(0,0,0,.45)"}},e.email))))})))),o.a.createElement(v.a.Item,{name:"status",label:"\u72b6\u6001"},o.a.createElement(j.a.Group,{name:"radiogroup",onChange:function(e){b(e.target.value)}},o.a.createElement(j.a,{value:"todo"},"\u672a\u5f00\u59cb"),o.a.createElement(j.a,{value:"doing"},"\u8fdb\u884c\u4e2d"),o.a.createElement(j.a,{value:"done"},"\u5df2\u5b8c\u6210"))),"todo"!==E?o.a.createElement(v.a.Item,{name:"startDate",label:"\u5f00\u59cb\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65e5\u671f\uff01"}]},o.a.createElement(g.a,null)):null,"done"===E?o.a.createElement(v.a.Item,{name:"endDate",label:"\u5b8c\u6210\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5b8c\u6210\u65e5\u671f\uff01"}]},o.a.createElement(g.a,null)):null))}var x=a(75);function _(e){var t=Object(c.useState)(!1),a=Object(l.a)(t,2),s=a[0],u=a[1],i=Object(c.useState)({users:[]}),d=Object(l.a)(i,2),m=d[0],f=d[1],E=Object(c.useState)([]),p=Object(l.a)(E,2),v=p[0],D=p[1],O=Object(c.useState)(),j=Object(l.a)(O,2),g=j[0],k=j[1];return Object(c.useEffect)((function(){Object(x.i)().then((function(e){var t=e.data;0===t.code&&D(t.data)}))}),[]),Object(c.useEffect)((function(){k(e.data)}),[e.data]),o.a.createElement(o.a.Fragment,null,o.a.createElement(b,Object.assign({},e,{data:g,onItemEditClick:function(e){u(!0),f(e)}})),o.a.createElement(I,{visible:s,onOk:function(t){t.startDate=t.startDate?t.startDate.format("YYYY-MM-DD"):null,t.endDate=t.endDate?t.endDate.format("YYYY-MM-DD"):null,t.users=v.filter((function(e){return-1!==t.selectedUsers.indexOf(e._id)}));var a=m._id;Object(x.g)(Object(r.a)(Object(r.a)({},m),t)).then((function(t){var n=t.data;if(0===n.code){var r=g.map((function(e){return e._id===a?n.data:e}));e.updateTasks(r),u(!1)}}))},onCancel:function(){u(!1)},task:m,users:[].concat(Object(n.a)(m.users),Object(n.a)(v))}))}},649:function(e,t,a){e.exports={container:"uhJNy-LGfyZSV_d-QGjs-",date:"_2cYU0aORhMpwzIIqBrDPrI"}},650:function(e,t,a){e.exports={container:"_3j3ghdkSsdKz1tNY21hoIL",title:"_1yCzZg1J4ovXq3vPTvNaUQ",taskList:"_2cAdd5AFC1pl0ssVvfqHf5"}},675:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return x}));var n=a(31),r=a(0),l=a.n(r),c=a(428),o=a(89),s=a(667),u=a(492),i=a(356),d=a(678),m=a(190),f=a.n(m),E=a(347),b=a(109),p=a(350),v=a(649),D=a.n(v);function O(e){var t=e.task,a=e.index;return l.a.createElement(c.b,{draggableId:t._id,index:a},(function(e,a){return l.a.createElement("div",Object.assign({className:D.a.container,ref:e.innerRef},e.draggableProps,e.dragHandleProps),l.a.createElement(s.a,{hoverable:!0},l.a.createElement("p",null,t.content),l.a.createElement("div",{className:D.a.date},function(e){switch(e.status){case"todo":return"\u521b\u5efa\u4e8e"+f()(e.createDate).format("MM-DD");case"doing":return"\u5f00\u59cb\u4e8e"+f()(e.startDate).format("MM-DD");case"done":return"\u5b8c\u6210\u4e8e"+f()(e.endDate).format("MM-DD")}}(t)),l.a.createElement("div",null,l.a.createElement(E.a.Group,null,t.users.map((function(e){return l.a.createElement(b.a,{key:e._id,title:e.username,placement:"top"},l.a.createElement(E.a,{style:{backgroundColor:e.avatar},icon:l.a.createElement(p.a,null)}))}))))))}))}var j=a(650),g=a.n(j);function k(e){var t=e.status,a=e.tasks,n=e.id;return l.a.createElement("div",{className:g.a.container},l.a.createElement("h4",{className:g.a.title,style:{backgroundColor:t.color}},t.display),l.a.createElement(c.c,{droppableId:n},(function(e){return l.a.createElement("div",Object.assign({className:g.a.taskList,ref:e.innerRef},e.droppableProps),a.map((function(e,t){return l.a.createElement(O,{key:e._id,task:e,index:t})})),e.placeholder)})))}var y=a(395),h=a(75),I=a(394);function x(e){var t=Object(r.useState)("board"),a=Object(n.a)(t,2),m=a[0],E=a[1],b=Object(r.useState)(""),p=Object(n.a)(b,2),v=p[0],D=p[1],O=Object(r.useState)({todo:[],doing:[],done:[]}),j=Object(n.a)(O,2),g=j[0],x=j[1];Object(r.useEffect)((function(){var t=e.match.params,a=t.type||"sprint",n=t.id||"530000197311083057";D(("sprint"===a?"\u9636\u6bb5":"\u9700\u6c42")+n),Object(h.o)({type:a,id:n}).then((function(e){var t=e.data;if(0===t.code){var a=t.data,n=Object(I.a)(a);x(n)}}))}),[]);var _=Object.values(g).flat(),Y=0===_.length?l.a.createElement(o.a,{image:o.a.PRESENTED_IMAGE_SIMPLE}):l.a.createElement(c.a,{onDragEnd:function(e){var t=e.destination,a=e.source,n=e.draggableId;if(t&&(t.droppableId!==a.droppableId||t.index!==a.index)){var r=a.droppableId,l=t.droppableId,c=g[r].find((function(e){return e._id===n}));c.status=l,"todo"===l&&(c.startDate=null,c.endDate=null),"doing"===l&&(c.startDate=f()().format("YYYY-MM-DD"),c.endDate=null),"done"===l&&(c.endDate=f()().format("YYYY-MM-DD"));var o=g[r],s=g[l];o.splice(a.index,1),s.splice(t.index,0,c),x(g)}}},l.a.createElement("div",{style:{display:"flex"}},Object.keys(I.b).map((function(e,t){return l.a.createElement(k,{status:I.b[e],id:e,key:t,tasks:g[e]})})))),C=l.a.createElement(y.a,{data:_,status:I.b,updateTasks:function(e){x(Object(I.a)(e))}});return l.a.createElement(s.a,{title:v,extra:l.a.createElement(u.a.Group,{buttonStyle:"solid",onChange:function(e){E(e.target.value)},value:m},l.a.createElement(u.a.Button,{value:"board"},l.a.createElement(i.a,null)),l.a.createElement(u.a.Button,{value:"list"},l.a.createElement(d.a,null)))},"board"===m?Y:C)}}}]);
//# sourceMappingURL=9.64274356.chunk.js.map