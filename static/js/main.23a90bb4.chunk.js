(this.webpackJsonppms=this.webpackJsonppms||[]).push([[0],{118:function(e,t,a){e.exports={container:"_2RVmFXkm3NpCTVXrhpAky_",content:"_2Htpzx3R8oKPu3PkWf4WoK",main:"_1f5ImrUK28jULxBPy6Vr4Z"}},148:function(e,t,a){e.exports={container:"_1OudY3eOKhometcdjAwwJe",block:"_3XQvD5xzQqFYVc82P0lIj5",todo:"F8xQiMGthcmBSQ-2y0WyE",doing:"_3iTTJmnixGLrDuefYG5tpt",done:"_27SZsenZ6rYbNWvlmf0x5x"}},169:function(e,t,a){e.exports={header:"_3KC7A6KeRiBRBNS8pjubt2",logout:"_2ZSJ5f9P9bbeghV5GDeiDl",trigger:"_1HT5wiUkXowZkSyhDkNL_r",title:"_3PD8D_5zvRE42Yw2v6pHeH"}},217:function(e,t,a){e.exports={container:"_28Yq8Uj4udGSGVy9BijsDd",title:"_3qdcpPcztQVfUl2awh8bA6",taskList:"r7XB1Ka3JINz4aqCER96g"}},248:function(e,t,a){e.exports={sider:"_1ouATjjGDUa7atLAzCEEI1",logo:"_11ozg1j2cLMixBMi6Bvoxz"}},249:function(e,t,a){e.exports={container:"_2HGpQcOxDIzDn9vTQMCg0m",date:"_1FIFhu2ilokbdq6x52XLA-"}},360:function(e,t,a){e.exports={curSprint:"_21kfxKD7nJ8vn4TuGLGB3u"}},376:function(e,t,a){e.exports=a(662)},661:function(e,t,a){},662:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),o=a.n(c),l=a(52),s=a(82),i=a(38),u=a(11),d=a(367),m=a(66),p=a(335),f=a(336),h=a(9),b={username:"",email:"",msg:""};var E={projectName:"",startDate:null,endDate:null,description:"",msg:""};var v=a(62),g=[];var k=Object(m.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_SUCCESS":case"RECEIVE_USER":return t.data;case"RESET_USER":return Object(h.a)(Object(h.a)({},b),{},{msg:t.data});case"ERROR_MSG":return Object(h.a)(Object(h.a)({},e),{},{msg:t.data});default:return e}},project:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SWITCH_PROJECT":return t.data;case"RESET_PROJECT":return Object(h.a)(Object(h.a)({},E),{},{msg:t.data});case"ERROR_MSG":return Object(h.a)(Object(h.a)({},e),{},{msg:t.data});default:return e}},sprints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_SPRINTS":return t.data;case"CREATE_SPRINT":return[].concat(Object(v.a)(e),[t.data]);default:return e}}}),j=Object(m.createStore)(k,Object(f.composeWithDevTools)(Object(m.applyMiddleware)(p.a))),y=a(28),O=a(29),D=a(31),x=a(30),C=a(669),S=a(676),I=a(366),w=a(677),_=a(40),T=a(678),M=a(679),R=a(32),N=a.n(R),F=a(118),Y=a.n(F),P=a(64),V=a.n(P),L=a(98),A=a(215),q=a.n(A),K=a(16),U=a.n(K),G="http://mock";U.a.mock("".concat(G,"/users/login"),"post",(function(e){var t=U.a.mock("@id");return N.a.set("userId",t),{code:0,data:{username:JSON.parse(e.body).username,_id:t}}})),U.a.mock("".concat(G,"/users/register"),"post",(function(e){var t=JSON.parse(e.body);if("guoyunxiang"===t.username)return{code:1,msg:"\u7528\u6237\u540d\u5df2\u7ecf\u88ab\u6ce8\u518c"};var a=U.a.mock("@id");return N.a.set("userId",a),{code:0,data:{username:t.username,_id:a}}})),U.a.mock("".concat(G,"/users/user"),"get",(function(){return{code:0,data:{username:U.a.mock("@last"),_id:N.a.get("userId")}}})),U.a.mock("".concat(G,"/projects/list"),"get",(function(){var e=U.a.mock({"data|5-10":[{_id:"@id",projectName:"@ctitle",description:"@cparagraph(2,3)",startDate:"2020-07-14",endDate:"2020-12-24"}]}).data;return{code:0,data:Object(v.a)(e)}})),U.a.mock("".concat(G,"/projects/create"),"post",(function(e){return{code:0,data:Object(h.a)(Object(h.a)({},JSON.parse(e.body)),{},{_id:U.a.mock("@id")})}})),U.a.mock(RegExp("".concat(G,"/projects/edit/")+".*"),"post",(function(e){return{code:0,data:Object(h.a)({},JSON.parse(e.body))}})),U.a.mock("".concat(G,"/projects/project"),"get",(function(){return{code:0,data:{projectName:U.a.mock("@ctitle"),description:U.a.mock("@cparagraph(2,3)"),_id:N.a.get("projectId"),startDate:"2020-07-14",endDate:"2020-12-24"}}})),U.a.mock(RegExp("".concat(G,"/tasks/list")+".*"),"get",(function(e){return Object(h.a)({code:0},U.a.mock({"data|10-15":[{_id:"@id",content:"@csentence","status|1":["todo","doing","done"],storyId:"@id",projectId:N.a.get("projectId"),createDate:"@date",startDate:function(){return"todo"!==this.status?U.a.mock("@date"):null},endDate:function(){return"done"===this.status?U.a.mock("@date"):null},"users|0-5":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last"}]}]}))})),U.a.mock("".concat(G,"/projects/members"),"get",(function(){return Object(h.a)({code:0},U.a.mock({"data|8-12":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last",email:"@email","roles|1-4":[{"color|1":["#f56a00","#7265e6","#00a2ae","#ffbf00"],"name|1":["\u9879\u76ee\u7ecf\u7406","\u524d\u7aef\u5f00\u53d1","\u540e\u7aef\u5f00\u53d1","UI\u8bbe\u8ba1"]}]}]}))})),U.a.mock("".concat(G,"/users/list"),"get",(function(){return Object(h.a)({code:0},U.a.mock({"data|5-8":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last",email:"@email"}]}))})),U.a.mock("".concat(G,"/sprints/create"),"post",(function(e){return{code:0,data:Object(h.a)(Object(h.a)({_id:U.a.mock("@id")},JSON.parse(e.body)),{},{tasks:{todo:[],doing:[],done:[]}})}})),U.a.mock("".concat(G,"/sprints/list"),"get",(function(){return{code:0,data:[Object(h.a)({_id:U.a.mock("@id"),startDate:"2020-07-14",endDate:"2020-07-30"},U.a.mock({"tasks|10-20":[{_id:"@id",content:"@csentence","status|1":["todo","doing","done"],projectId:N.a.get("projectId"),createDate:"@date",startDate:function(){return"todo"!==this.status?U.a.mock("@date"):null},endDate:function(){return"done"===this.status?U.a.mock("@date"):null},"users|0-5":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last"}]}]})),Object(h.a)({_id:U.a.mock("@id"),startDate:"2020-07-31",endDate:"2020-08-26"},U.a.mock({"tasks|10-20":[{_id:"@id",content:"@csentence","status|1":["todo","doing","done"],projectId:N.a.get("projectId"),createDate:"@date",startDate:function(){return"todo"!==this.status?U.a.mock("@date"):null},endDate:function(){return"done"===this.status?U.a.mock("@date"):null},"users|0-5":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last"}]}]})),Object(h.a)({_id:U.a.mock("@id"),startDate:"2020-08-27",endDate:"2020-09-13"},U.a.mock({"tasks|10-20":[{_id:"@id",content:"@csentence","status|1":["todo","doing","done"],projectId:N.a.get("projectId"),createDate:"@date",startDate:function(){return"todo"!==this.status?U.a.mock("@date"):null},endDate:function(){return"done"===this.status?U.a.mock("@date"):null},"users|0-5":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last"}]}]}))]}})),U.a.mock("".concat(G,"/stories/list"),"get",(function(){return Object(h.a)({code:0},U.a.mock({"data|8-10":[{_id:"@id","role|1":["\u7528\u6237","VIP","\u7ba1\u7406\u5458","\u9879\u76ee\u7ecf\u7406"],activity:"@cword(10, 15)",date:"@date","priority|1":[0,1,2],businessValue:"@cword(10, 15)","tasks|3-5":[{_id:"@id",content:"@csentence","status|1":["todo","doing","done"],projectId:N.a.get("projectId"),createDate:"@date",startDate:function(){return"todo"!==this.status?U.a.mock("@date"):null},endDate:function(){return"done"===this.status?U.a.mock("@date"):null},"users|0-5":[{_id:"@id","avatar|1":["#f56a00","#7265e6","#00a2ae"],username:"@last"}]}]}]}))})),U.a.mock("".concat(G,"/tasks/create"),"post",(function(e){return{code:0,data:Object(h.a)(Object(h.a)({},JSON.parse(e.body)),{},{_id:U.a.mock("@id"),projectId:N.a.get("projectId")})}})),U.a.mock("".concat(G,"/storys/create"),"post",(function(e){return{code:0,data:Object(h.a)(Object(h.a)({},JSON.parse(e.body)),{},{_id:U.a.mock("@id"),tasks:{todo:[],doing:[],done:[]},projectId:N.a.get("projectId")})}})),U.a.mock(RegExp("".concat(G,"/storys/edit/")+".*"),"post",(function(e){return{code:0,data:Object(h.a)({},JSON.parse(e.body))}})),U.a.mock(RegExp("".concat(G,"/tasks/edit/")+".*"),"post",(function(e){return{code:0,data:Object(h.a)({},JSON.parse(e.body))}})),U.a.mock("".concat(G,"/test"),"get",{code:1,msg:"\u8bf7\u6c42\u8fd4\u56de\u7684\u975e\u6b63\u5e38\u4fe1\u606f"});var z=a(370);function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";if("GET"===a){var n="";return Object.keys(t).forEach((function(e){n+=e+"="+t[e]+"&"})),n&&(n="?"+n.substring(0,n.length-1)),q.a.get("http://mock"+e+n)}return q.a.post("http://mock"+e,t)}q.a.interceptors.response.use((function(e){var t=e.data;if(200!==e.status||0===t.code)return e;z.b.error(t.msg)}));var H=function(e){return J("/users/login",{username:e.username,password:e.password},"POST")},B=function(e){return J("/users/register",{username:e.username,password:e.password},"POST")},Q=function(e){return J("/projects/create",{projectName:e.projectName,startDate:e.startDate,endDate:e.endDate,description:e.description},"POST")},W=function(e){var t=e._id,a=e.projectName,n=e.startDate,r=e.endDate,c=e.description;return J("/projects/edit/".concat(t),{_id:t,projectName:a,startDate:n,endDate:r,description:c},"POST")},X=function(e){return J("/tasks/list",e)},Z=function(){return J("/projects/members")},$=function(){return J("/sprints/list")},ee=function(e){return J("/sprints/create",{startDate:e.startDate,endDate:e.endDate},"POST")},te=function(e){var t=e.content,a=e.createDate,n=e.status,r=void 0===n?"todo":n,c=e.users;return J("/tasks/create",{content:t,createDate:a,status:r,users:void 0===c?[]:c},"POST")},ae=function(e){return J("/storys/create",{role:e.role,activity:e.activity,priority:e.priority,businessValue:e.businessValue,date:e.date},"POST")},ne=function(e){var t=e._id,a=e.role,n=e.activity,r=e.priority,c=e.businessValue,o=e.date;return J("/storys/edit/".concat(t),{_id:t,role:a,activity:n,priority:r,businessValue:c,date:o},"POST")},re=function(){return J("/test")},ce=function(e){return{type:"AUTH_SUCCESS",data:e}},oe=function(e){return{type:"ERROR_MSG",data:e}},le=function(e){return{type:"RESET_USER",data:e}},se=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(t){e.props.login(t)},e.onFinishFailed=function(e){console.log("Failed:",e)},e.toRegister=function(){e.props.history.replace("/register")},e}return Object(O.a)(a,[{key:"render",value:function(){var e=N.a.get("userId"),t=this.props.user.msg;return e?r.a.createElement(i.a,{to:"/"}):r.a.createElement("div",{className:Y.a.container},r.a.createElement("div",{className:Y.a.content},r.a.createElement("div",{className:Y.a.main},r.a.createElement(C.a,{wrapperCol:{span:24},name:"loginForm",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed},r.a.createElement(C.a.Item,null,t?r.a.createElement(S.a,{type:"error",message:t,showIcon:!0}):null),r.a.createElement(C.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01"}]},r.a.createElement(I.a,{prefix:r.a.createElement(T.a,{className:"site-form-item-icon"}),placeholder:"\u7528\u6237\u540d"})),r.a.createElement(C.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01"}]},r.a.createElement(I.a.Password,{prefix:r.a.createElement(M.a,{className:"site-form-item-icon"}),placeholder:"\u5bc6\u7801"})),r.a.createElement(C.a.Item,null,r.a.createElement(w.b,null,r.a.createElement(_.a,{type:"primary",htmlType:"submit"},"\u767b\u5f55"),r.a.createElement(_.a,{htmlType:"button",onClick:this.toRegister},"\u6ce8\u518c\u8d26\u53f7")))))))}}]),a}(n.Component),ie=Object(l.b)((function(e){return{user:e.user}}),{login:function(e){var t=e.username,a=e.password;return t&&a?function(){var t=Object(L.a)(V.a.mark((function t(a){var n,r;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H(e);case 2:n=t.sent,0===(r=n.data).code?a(ce(r.data)):a(oe(r.msg));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}():oe("\u8bf7\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801")}})(se),ue=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(t){e.props.register(t),console.log("Success:",t)},e.onFinishFailed=function(e){console.log("Failed:",e)},e.toLogin=function(){e.props.history.replace("/login")},e}return Object(O.a)(a,[{key:"render",value:function(){var e=N.a.get("userId"),t=this.props.user.msg;return e?r.a.createElement(i.a,{to:"/"}):r.a.createElement("div",{className:Y.a.container},r.a.createElement("div",{className:Y.a.content},r.a.createElement("div",{className:Y.a.main},r.a.createElement(C.a,{wrapperCol:{span:24},name:"loginForm",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed},r.a.createElement(C.a.Item,null,t?r.a.createElement(S.a,{type:"error",message:t,showIcon:!0}):null),r.a.createElement(C.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01"}]},r.a.createElement(I.a,{prefix:r.a.createElement(T.a,{className:"site-form-item-icon"}),placeholder:"\u7528\u6237\u540d"})),r.a.createElement(C.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01"}]},r.a.createElement(I.a.Password,{prefix:r.a.createElement(M.a,{className:"site-form-item-icon"}),placeholder:"\u5bc6\u7801"})),r.a.createElement(C.a.Item,{name:"password2",rules:[{required:!0,message:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801\uff01"}]},r.a.createElement(I.a.Password,{prefix:r.a.createElement(M.a,{className:"site-form-item-icon"}),placeholder:"\u5bc6\u7801"})),r.a.createElement(C.a.Item,null,r.a.createElement(w.b,null,r.a.createElement(_.a,{type:"primary",htmlType:"submit"},"\u6ce8\u518c"),r.a.createElement(_.a,{htmlType:"button",onClick:this.toLogin},"\u5df2\u6709\u8d26\u53f7")))))))}}]),a}(n.Component),de=Object(l.b)((function(e){return{user:e.user}}),{register:function(e){var t=e.username,a=e.password,n=e.password2;return t&&a&&n?a!==n?oe("\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4"):function(){var t=Object(L.a)(V.a.mark((function t(a){var n,r;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(e);case 2:n=t.sent,0===(r=n.data).code?a(ce(r.data)):a(oe(r.msg));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}():oe("\u8bf7\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801")}})(ue),me=a(132),pe=a(663),fe=a(670),he=a(691),be=a(65),Ee=a(680),ve=a(681),ge=a(682),ke=a(683),je=a(684),ye=a(685),Oe=a(686),De=a(248),xe=a.n(De),Ce=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).menuList=[{path:"/project/profile",title:"\u9879\u76ee\u72b6\u6001",icon:r.a.createElement(Ee.a,null)},{path:"/project/member",title:"\u6210\u5458\u7ba1\u7406",icon:r.a.createElement(ve.a,null)},{path:"/project/story",title:"\u9700\u6c42\u5206\u6790",icon:r.a.createElement(ge.a,null)},{path:"/project/sprint",title:"\u9636\u6bb5\u8bbe\u7f6e",icon:r.a.createElement(ke.a,null)},{path:"/project/board",title:"\u4efb\u52a1\u770b\u677f",icon:r.a.createElement(je.a,null)},{path:"/project/meeting",title:"\u4f1a\u8bae\u7eaa\u8981",icon:r.a.createElement(ye.a,null)},{path:"/account",title:"\u4e2a\u4eba\u4e2d\u5fc3",icon:r.a.createElement(T.a,null)},{path:"/test",title:"\u529f\u80fd\u6d4b\u8bd5",icon:r.a.createElement(Oe.a,null)}],e}return Object(O.a)(a,[{key:"render",value:function(){var e=this,t=this.props.visiable,a=this.props.location.pathname,n=this.menuList.findIndex((function(e){return new RegExp(e.path).test(a)})).toString();return r.a.createElement(pe.a.Sider,{trigger:null,collapsible:!0,collapsed:this.props.collapsed,className:xe.a.sider,style:{display:t?"":"none"}},r.a.createElement("div",{className:xe.a.logo},"PMS"),r.a.createElement(be.a,{theme:"dark",mode:"inline",selectedKeys:[n]},this.menuList.map((function(t,a){return r.a.createElement(be.a.Item,{key:a,icon:t.icon,onClick:function(){t.path&&e.props.history.replace(t.path)}},t.title)}))))}}]),a}(n.Component),Se=Object(i.g)(Ce),Ie=a(673),we=a(687),_e=a(688),Te=a(689),Me=a(169),Re=a.n(Me),Ne=function(e){return r.a.createElement(pe.a.Header,{className:Re.a.header},e.visiable&&r.a.createElement(e.collapsed?we.a:_e.a,{className:Re.a.trigger,onClick:e.toggle}),r.a.createElement("div",{className:Re.a.title},r.a.createElement(s.b,{to:"/"},e.projectName)),r.a.createElement("div",null,r.a.createElement(Ie.a,{style:{backgroundColor:"#00a2ae",marginRight:8},icon:r.a.createElement(T.a,null)}),e.username),r.a.createElement(Te.a,{className:Re.a.logout,onClick:e.logout}))},Fe=a(668),Ye=a(692),Pe=a(667),Ve=a(690),Le=Pe.a.Column;function Ae(e){var t=e.data;return r.a.createElement(Pe.a,{dataSource:t,pagination:!1,showHeader:!1,rowKey:"_id"},r.a.createElement(Le,{title:"\u4fe1\u606f",dataIndex:"projectName",key:"projectName",render:function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,r.a.createElement("a",{onClick:function(){return e.onConfirm(a)}},t)),r.a.createElement("div",{style:{color:"rgba(0,0,0,.45)",marginTop:"4px"}},a.description))}}),r.a.createElement(Le,{title:"\u65f6\u95f4",key:"date",render:function(e,t){return"".concat(t.startDate,"~").concat(t.endDate)}}),r.a.createElement(Le,{title:"\u64cd\u4f5c",dataIndex:"_id",key:"action",render:function(t,a){return r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.onItemEditClick(a)}},r.a.createElement(Ve.a,null))}}))}var qe=a(54),Ke=a(666),Ue=a(24),Ge=a.n(Ue),ze=Ke.a.RangePicker;function Je(e){var t=e.visible,a=e.onOk,c=e.onCancel,o=e.project,l=C.a.useForm(),s=Object(qe.a)(l,1)[0];return Object(n.useEffect)((function(){if(o){var e=[Ge()(o.startDate),Ge()(o.endDate)];s.setFieldsValue(Object(h.a)(Object(h.a)({},o),{},{rangeDate:e}))}else s.resetFields()})),r.a.createElement(fe.a,{forceRender:!0,title:o?"\u7f16\u8f91\u9879\u76ee":"\u521b\u5efa\u9879\u76ee",width:640,visible:t,onOk:function(){s.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{form:s,labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(C.a.Item,{name:"projectName",label:"\u9879\u76ee\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0\uff01"}]},r.a.createElement(I.a,{placeholder:"\u8bf7\u8f93\u5165"})),r.a.createElement(C.a.Item,{name:"rangeDate",label:"\u9879\u76ee\u65f6\u95f4",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u65f6\u95f4\uff01"}]},r.a.createElement(ze,{style:{width:"100%"}})),r.a.createElement(C.a.Item,{name:"description",label:"\u9879\u76ee\u7b80\u4ecb",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u9879\u76ee\u7b80\u4ecb\uff01",min:5}]},r.a.createElement(I.a.TextArea,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"}))))}var He=function(e){return{type:"SWITCH_PROJECT",data:e}},Be=function(e){return{type:"RESET_PROJECT",data:e}},Qe=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,projectList:[],current:null},e.showModal=function(t){e.setState({visible:!0,current:t})},e.handleConfirm=function(t){var a=Object(me.a)(e);fe.a.confirm({title:"\u9009\u62e9\u5e76\u5207\u6362\u81f3\u8be5\u9879\u76ee\uff1f",icon:r.a.createElement(he.a,null),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",onOk:function(){a.props.switchProject(t),N.a.set("projectId",t._id),a.props.history.push("/project/profile")}})},e.handleOk=function(t){var a=e.state.current,n=a?a._id:"",r=t.rangeDate;t.startDate=r[0].format("YYYY-MM-DD"),t.endDate=r[1].format("YYYY-MM-DD"),n?W(Object(h.a)(Object(h.a)({},t),{},{_id:n})).then((function(t){var a=t.data;if(0===a.code){var r=e.state.projectList.map((function(e){return e._id===n?a.data:e}));e.setState({projectList:r,visible:!1}),n===e.props.project._id&&e.props.switchProject(a.data)}})):Q(t).then((function(t){var a=t.data;0===a.code&&e.setState({projectList:[a.data].concat(Object(v.a)(e.state.projectList)),visible:!1})}))},e.handleCancel=function(){e.setState({visible:!1})},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;J("/projects/list").then((function(t){var a=t.data;0===a.code&&e.setState({projectList:a.data})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.projectList,n=t.current;return r.a.createElement("div",null,r.a.createElement(Fe.a,{title:"\u6211\u7684\u9879\u76ee",extra:r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.showModal()}},r.a.createElement(Ye.a,{style:{fontSize:"24px"}}))},r.a.createElement(Ae,{data:a,onConfirm:this.handleConfirm,onItemEditClick:this.showModal})),r.a.createElement(Je,{visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,project:n}))}}]),a}(n.Component),We={switchProject:He},Xe=Object(l.b)((function(e){return{project:e.project}}),We)(Qe),Ze=a(672),$e=a(147),et=a(87),tt=a(148),at=a.n(tt);var nt=function(e){function t(e,t){for(var a=[],n=0;n<e;n++){var c=r.a.createElement("div",{key:n,className:"".concat(at.a.block," ").concat(t)});a.push(c)}return a}return r.a.createElement("div",{className:at.a.container},t(e.todo,at.a.todo),t(e.doing,at.a.doing),t(e.done,at.a.done))},rt=a(57);a(605),a(627),a(638),a(639);var ct=Ze.a.Countdown,ot={title:{text:"\u71c3\u5c3d\u56fe"},legend:{data:["\u5269\u4f59\u4efb\u52a1"],selectedMode:!1,top:10},grid:{left:"2%",right:"2%",bottom:"2%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:{type:"category",boundaryGap:!1,data:["09-17","09-18","09-19","09-20","09-21","09-22","09-23","09-24","09-25","09-26","09-27","09-28","09-29"]},yAxis:{type:"value"},series:[{name:"\u5269\u4f59\u4efb\u52a1",data:[56,50,55,48,40,30,24,22,15,11,8,3,2,1],type:"line",areaStyle:{}},{data:[["09-17",56],["09-29",0]],type:"line",lineStyle:{type:"dashed"}}]},lt=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){return Object(y.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){var t=rt.init(e.chart,"light");t.setOption(ot),t.on("finished",(function(){t.resize()}))}),0)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement($e.a,{gutter:[16,16]},r.a.createElement(et.a,{span:8},r.a.createElement(Fe.a,{hoverable:!0,onClick:function(){e.props.history.replace("/project/sprint")}},r.a.createElement(ct,{title:"\u8ddd\u79bb\u9636\u6bb5\u7ed3\u675f",value:Ge()("2020-10-12"),format:"D \u5929 H \u65f6",valueStyle:{color:"#cf1322"}}))),r.a.createElement(et.a,{span:8},r.a.createElement(Fe.a,{hoverable:!0,onClick:function(){e.props.history.replace("/project/board")}},r.a.createElement(Ze.a,{title:"\u9636\u6bb5\u4efb\u52a1",value:56}))),r.a.createElement(et.a,{span:8},r.a.createElement(Fe.a,{hoverable:!0,onClick:function(){e.props.history.replace("/project/member")}},r.a.createElement(Ze.a,{title:"\u9879\u76ee\u6210\u5458",value:13,prefix:r.a.createElement(ve.a,null)})))),r.a.createElement($e.a,{gutter:[16,16]},r.a.createElement(et.a,{span:24},r.a.createElement(Fe.a,null,r.a.createElement("div",{ref:function(t){e.chart=t},style:{width:"100%",height:"400px"}})))))}}]),a}(n.Component),st=a(674),it=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){return Object(y.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return r.a.createElement(Fe.a,null,r.a.createElement(st.a,{size:"middle",title:"\u9636\u6bb5\u4f8b\u4f1a",bordered:!0,column:2},r.a.createElement(st.a.Item,{label:"\u4f1a\u8bae\u65f6\u95f4"},"2020-09-12"),r.a.createElement(st.a.Item,{label:"\u4f1a\u8bae\u5730\u70b9"},"302"),r.a.createElement(st.a.Item,{label:"\u53c2\u4f1a\u4eba\u5458",span:2},"\u5f20\u4e09\uff0c\u674e\u56db\uff0c\u738b\u4e94"),r.a.createElement(st.a.Item,{label:"\u4f1a\u8bae\u5185\u5bb9",span:2},"\u88c5\u6797\u6b65\u8f66\u8f6c\u4f53\u9886\u89d2\u8ba4\u5206\u529e\u4e3a\u5fc3\u8fd9\u56e0\u3002\u5408\u822c\u5f62\u8c61\u8005\u52b3\u65af\u77e5\u7ba1\u4ee5\u5317\u62c9\u9886\u5230\u6cbb\u3002\u793a\u6cb9\u8282\u8d70\u4e0d\u6559\u53cd\u56de\u751f\u53bb\u8f66\u4e4b\u70ed\u4f5c\u3002",r.a.createElement("br",null),"\u5979\u5b9a\u611f\u8ba4\u540e\u7387\u6c11\u4f5c\u519b\u91cc\u5355\u7531\u529e\u773c\u5e73\u3002\u4e66\u5f3a\u9769\u7535\u5f0f\u6bcf\u79d1\u53bb\u540c\u653f\u5f62\u51c6\u7ea2\u5b9e\u3002",r.a.createElement("br",null),"\u6210\u4eec\u53ea\u8fdb\u534e\u738b\u7b2c\u89c4\u60c5\u515a\u5706\u4e2d\u524d\u7fa4\u534a\u81ea\u3002\u6797\u8fbe\u7a7a\u77ff\u771f\u4eb2\u5206\u4ed6\u8bdd\u95f4\u767d\u534e\u3002"),r.a.createElement(st.a.Item,{label:"\u5f85\u529e\u4e8b\u9879"},"\u5df1\u81ea\u7f8e\u7d20\u9886\u6bb5\u7136\u5f97\u793a\u5305\u6c34\u6d4e\u786e\u5f20\u4f55\u53ea\u3002\u7531\u4ec0\u4e16\u5411\u6c34\u5e74\u5317\u5f00\u4eb2\u5357\u4ea4\u5c31\u6cbb\u9020\u3002",r.a.createElement("br",null),"\u56e2\u5f71\u5149\u5c06\u6599\u53d7\u6253\u9636\u56fe\u5c42\u5fd7\u4e14\u5c0f\u88ab\u5668\u3002\u751f\u6ee1\u59d4\u7269\u66f4\u95e8\u79f0\u5f0f\u4e0a\u53ca\u754c\u5f80\u6d3e\u5f0f\u4e1c\u5411\u601d\u3002",r.a.createElement("br",null),"\u8282\u590d\u5bfc\u5e94\u8bbe\u6539\u516b\u5e72\u4e07\u671f\u76f4\u901a\u6210\u6570\u6c5f\u3002\u5b50\u4e00\u4e8c\u6253\u77e5\u62c9\u5b50\u5b9e\u6599\u7ed3\u8d8a\u56e2\u8bba\u7b49\u79d1\u9700\u5c55\u3002")))}}]),a}(n.Component),ut=a(142),dt=a(101),mt=a(210),pt=a(693),ft=a(111),ht=a(249),bt=a.n(ht),Et=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){return Object(y.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){var e=this.props,t=e.task,a=e.index;return r.a.createElement(ut.b,{draggableId:t._id,index:a},(function(e,a){return r.a.createElement("div",Object.assign({className:bt.a.container,ref:e.innerRef},e.draggableProps,e.dragHandleProps),r.a.createElement(Fe.a,{hoverable:!0},r.a.createElement("p",null,t.content),r.a.createElement("div",{className:bt.a.date},function(e){switch(e.status){case"todo":return"\u521b\u5efa\u4e8e"+Ge()(e.createDate).format("MM-DD");case"doing":return"\u5f00\u59cb\u4e8e"+Ge()(e.startDate).format("MM-DD");case"done":return"\u5b8c\u6210\u4e8e"+Ge()(e.endDate).format("MM-DD")}}(t)),r.a.createElement("div",null,r.a.createElement(Ie.a.Group,null,t.users.map((function(e){return r.a.createElement(ft.a,{key:e._id,title:e.username,placement:"top"},r.a.createElement(Ie.a,{style:{backgroundColor:e.avatar},icon:r.a.createElement(T.a,null)}))}))))))}))}}]),a}(n.Component),vt=a(217),gt=a.n(vt),kt=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){return Object(y.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){var e=this.props,t=e.status,a=e.tasks;return r.a.createElement("div",{className:gt.a.container},r.a.createElement("h4",{className:gt.a.title,style:{backgroundColor:t.color}},t.display),r.a.createElement(ut.c,{droppableId:this.props.id},(function(e){return r.a.createElement("div",Object.assign({className:gt.a.taskList,ref:e.innerRef},e.droppableProps),a.map((function(e,t){return r.a.createElement(Et,{key:e._id,task:e,index:t})})),e.placeholder)})))}}]),a}(n.Component),jt=a(371),yt=Pe.a.Column;function Ot(e){var t=e.data,a=e.status,n=e.size,c=void 0===n?"default":n,o=e.onItemEditClick,l=e.editable,s=void 0===l||l;return r.a.createElement(Pe.a,{dataSource:t,pagination:!1,rowKey:"_id",size:c},r.a.createElement(yt,{width:"90px",title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){var t=a[e];return r.a.createElement(jt.a,{color:t.color},t.display)}}),r.a.createElement(yt,{title:"\u5185\u5bb9",dataIndex:"content",key:"content"}),r.a.createElement(yt,{title:"\u53c2\u4e0e\u8005",dataIndex:"users",key:"users",render:function(e){return r.a.createElement(Ie.a.Group,null,e.map((function(e){return r.a.createElement(ft.a,{key:e._id,title:e.username,placement:"top"},r.a.createElement(Ie.a,{style:{backgroundColor:e.avatar},icon:r.a.createElement(T.a,null)}))})))}}),r.a.createElement(yt,{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"createDate"}),r.a.createElement(yt,{title:"\u5f00\u59cb\u65e5\u671f",dataIndex:"startDate"}),r.a.createElement(yt,{title:"\u5b8c\u6210\u65e5\u671f",dataIndex:"endDate"}),s?r.a.createElement(yt,{title:"\u64cd\u4f5c",dataIndex:"_id",key:"action",render:function(e,t){return r.a.createElement("a",{onClick:function(e){e.preventDefault(),o(t)}},r.a.createElement(Ve.a,null))}}):null)}var Dt=a(166),xt=Dt.a.Option;function Ct(e){var t=e.visible,a=e.onOk,c=e.onCancel,o=e.task,l=e.users,s=Object(n.useState)(),i=Object(qe.a)(s,2),u=i[0],d=i[1],m=C.a.useForm(),p=Object(qe.a)(m,1)[0];return Object(n.useEffect)((function(){if(o){d(o.status);var e=o.startDate?Ge()(o.startDate):Ge()(),t=o.endDate?Ge()(o.endDate):Ge()(),a=o.users.map((function(e){return e._id}));p.setFieldsValue(Object(h.a)(Object(h.a)({},o),{},{selectedUsers:a,startDate:e,endDate:t}))}else p.resetFields()}),[o]),r.a.createElement(fe.a,{forceRender:!0,title:"\u7f16\u8f91\u4efb\u52a1",width:640,visible:t,onOk:function(){p.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{form:p,labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(C.a.Item,{name:"selectedUsers",label:"\u53c2\u4e0e\u8005",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u53c2\u4e0e\u8005\uff01"}]},r.a.createElement(Dt.a,{showSearch:!0,placeholder:"\u9009\u62e9\u53c2\u4e0e\u8005",optionFilterProp:"title",optionLabelProp:"title",mode:"multiple"},l.map((function(e,t){return r.a.createElement(xt,{key:t,value:e._id,title:e.username},r.a.createElement(w.b,null,r.a.createElement(Ie.a,{style:{backgroundColor:e.avatar},icon:r.a.createElement(T.a,null)}),r.a.createElement("div",null,r.a.createElement("a",null," ",e.username),r.a.createElement("div",{style:{color:"rgba(0,0,0,.45)"}},e.email))))})))),r.a.createElement(C.a.Item,{name:"status",label:"\u72b6\u6001"},r.a.createElement(mt.a.Group,{name:"radiogroup",onChange:function(e){d(e.target.value)}},r.a.createElement(mt.a,{value:"todo"},"\u672a\u5f00\u59cb"),r.a.createElement(mt.a,{value:"doing"},"\u8fdb\u884c\u4e2d"),r.a.createElement(mt.a,{value:"done"},"\u5df2\u5b8c\u6210"))),"todo"!==u?r.a.createElement(C.a.Item,{name:"startDate",label:"\u5f00\u59cb\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65e5\u671f\uff01"}]},r.a.createElement(Ke.a,null)):null,"done"===u?r.a.createElement(C.a.Item,{name:"endDate",label:"\u5b8c\u6210\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5b8c\u6210\u65e5\u671f\uff01"}]},r.a.createElement(Ke.a,null)):null))}function St(e){var t=Object(n.useState)(!1),a=Object(qe.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)({users:[]}),s=Object(qe.a)(l,2),i=s[0],u=s[1],d=Object(n.useState)([]),m=Object(qe.a)(d,2),p=m[0],f=m[1],b=Object(n.useState)(),E=Object(qe.a)(b,2),g=E[0],k=E[1];return Object(n.useEffect)((function(){0===p.length&&Z().then((function(e){var t=e.data;0===t.code&&f(t.data)}))})),Object(n.useEffect)((function(){k(e.data)}),[e.data]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ot,Object.assign({},e,{data:g,onItemEditClick:function(e){o(!0),u(e)}})),r.a.createElement(Ct,{visible:c,onOk:function(t){t.startDate=t.startDate?t.startDate.format("YYYY-MM-DD"):null,t.endDate=t.endDate?t.endDate.format("YYYY-MM-DD"):null,t.users=p.filter((function(e){return-1!==t.selectedUsers.indexOf(e._id)}));var a=i._id;(function(e){return J("/tasks/edit/".concat(e._id),e,"POST")})(Object(h.a)(Object(h.a)({},i),t)).then((function(t){var n=t.data;if(0===n.code){var r=g.map((function(e){return e._id===a?n.data:e}));e.updateTasks(r),o(!1)}}))},onCancel:function(){o(!1)},task:i,users:[].concat(Object(v.a)(i.users),Object(v.a)(p))}))}function It(e){var t={todo:[],doing:[],done:[]};return Array.isArray(e)&&e.forEach((function(e){t[e.status].push(e)})),t}var wt={todo:{color:"#4a9ff9",display:"\u672a\u5f00\u59cb"},doing:{color:"#f9944a",display:"\u8fdb\u884c\u4e2d"},done:{color:"#2ac06d",display:"\u5df2\u5b8c\u6210"}},_t=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={value:"board",title:"",tasks:{todo:[],doing:[],done:[]}},e.onChange=function(t){e.setState({value:t.target.value})},e.updateTasks=function(t){e.setState({tasks:It(t)})},e.onDragEnd=function(t){var a=t.destination,n=t.source,r=t.draggableId;if(a&&(a.droppableId!==n.droppableId||a.index!==n.index)){var c=n.droppableId,o=a.droppableId,l=e.state.tasks[c].find((function(e){return e._id===r}));l.status=o,"todo"===o&&(l.startDate=null,l.endDate=null),"doing"===o&&(l.startDate=Ge()().format("YYYY-MM-DD"),l.endDate=null),"done"===o&&(l.endDate=Ge()().format("YYYY-MM-DD"));var s=e.state.tasks,i=s[c],u=s[o];i.splice(n.index,1),u.splice(a.index,0,l),e.setState({tasks:s})}},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,a=t.type||"sprint",n=t.id||"530000197311083057",r=("sprint"===a?"\u9636\u6bb5":"\u9700\u6c42")+n;this.setState({title:r}),X({type:a,id:n}).then((function(t){var a=t.data;if(0===a.code){var n=It(a.data);e.setState({tasks:n})}}))}},{key:"render",value:function(){var e=this.state,t=e.tasks,a=e.value,n=e.title,c=Object.values(t).flat(),o=0===c.length?r.a.createElement(dt.a,{image:dt.a.PRESENTED_IMAGE_SIMPLE}):r.a.createElement(ut.a,{onDragEnd:this.onDragEnd},r.a.createElement("div",{style:{display:"flex"}},Object.keys(wt).map((function(e,a){return r.a.createElement(kt,{status:wt[e],id:e,key:a,tasks:t[e]})})))),l=r.a.createElement(St,{data:c,status:wt,updateTasks:this.updateTasks});return r.a.createElement(Fe.a,{title:n,extra:r.a.createElement(mt.a.Group,{buttonStyle:"solid",onChange:this.onChange,value:this.state.value},r.a.createElement(mt.a.Button,{value:"board"},r.a.createElement(je.a,null)),r.a.createElement(mt.a.Button,{value:"list"},r.a.createElement(pt.a,null)))},"board"===a?o:l)}}]),a}(n.Component),Tt=a(664),Mt=a(694),Rt=Dt.a.Option;function Nt(e){var t=e.visible,a=e.onOk,n=e.onCancel,c=e.member,o=e.users,l=e.roles,s=C.a.useForm(),i=Object(qe.a)(s,1)[0];return r.a.createElement(fe.a,{forceRender:!0,title:c?"\u7f16\u8f91\u6210\u5458":"\u6dfb\u52a0\u6210\u5458",width:640,visible:t,onOk:function(){i.validateFields().then((function(e){a(e),i.resetFields()})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{form:i,labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(C.a.Item,{name:"_id",label:"\u9879\u76ee\u6210\u5458",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u6210\u5458\uff01"}]},r.a.createElement(Dt.a,{showSearch:!0,placeholder:"\u9009\u62e9\u6210\u5458",optionLabelProp:"title",optionFilterProp:"title"},o.map((function(e,t){return r.a.createElement(Rt,{key:t,value:e._id,title:e.username},r.a.createElement(w.b,null,r.a.createElement(Ie.a,{style:{backgroundColor:e.avatar},icon:r.a.createElement(T.a,null)}),r.a.createElement("div",null,r.a.createElement("a",null," ",e.username),r.a.createElement("div",{style:{color:"rgba(0,0,0,.45)"}},e.email))))})))),r.a.createElement(C.a.Item,{name:"roles",label:"\u6210\u5458\u89d2\u8272",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6210\u5458\u89d2\u8272\uff01"}]},r.a.createElement(Dt.a,{mode:"multiple",allowClear:!0,placeholder:"\u9009\u62e9\u89d2\u8272"},l.map((function(e,t){return r.a.createElement(Rt,{key:t,value:e.name},e.name)}))))))}var Ft=[{color:"#f56a00",name:"\u9879\u76ee\u7ecf\u7406"},{color:"#7265e6",name:"\u524d\u7aef\u5f00\u53d1"},{color:"#00a2ae",name:"\u540e\u7aef\u5f00\u53d1"},{color:"#ffbf00",name:"UI\u8bbe\u8ba1"}],Yt=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={users:[],members:[],visible:!1},e.columns=[{title:"\u6210\u5458",dataIndex:"username",render:function(e,t){return r.a.createElement(w.b,null,r.a.createElement(Ie.a,{style:{backgroundColor:t.avatar},icon:r.a.createElement(T.a,null)}),r.a.createElement("a",null,e))}},{title:"\u90ae\u7bb1",dataIndex:"email",render:function(e){return r.a.createElement("span",{style:{color:"rgba(0,0,0,.45)"}},e)}},{title:"\u89d2\u8272",dataIndex:"roles",render:function(e){return e.map((function(e,t){return r.a.createElement(jt.a,{key:t,color:e.color},e.name)}))}},{title:"\u64cd\u4f5c",dataIndex:"_id",key:"action",render:function(t){return r.a.createElement(Tt.a,{placement:"left",title:"\u786e\u8ba4\u5220\u9664\u8be5\u6210\u5458\uff1f",onConfirm:function(){return e.handleDel(t)},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement("a",{key:"delete"},r.a.createElement(Mt.a,null)))}}],e.handleDel=function(t){var a=e.state.members.filter((function(e){return e._id!==t}));e.setState({members:a})},e.showModal=function(){e.setState({visible:!0})},e.handleOk=function(t){var a=e.state.users.find((function(e){return e._id===t._id})),n=e.state.users.filter((function(e){return e._id!==t._id})),r=Ft.filter((function(e){return-1!==t.roles.findIndex((function(t){return e.name===t}))})),c=[Object(h.a)(Object(h.a)({},a),{},{roles:r})].concat(Object(v.a)(e.state.members));e.setState({members:c,users:n,visible:!1})},e.handleCancel=function(){e.setState({visible:!1})},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;Z().then((function(t){var a=t.data;if(0===a.code){var n=a.data;e.setState({members:n})}})),J("/users/list").then((function(t){var a=t.data;if(0===a.code){var n=a.data;e.setState({users:n})}}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Fe.a,{title:"\u9879\u76ee\u6210\u5458",extra:r.a.createElement("a",{onClick:this.showModal},r.a.createElement(Ye.a,{style:{fontSize:"24px"}}))},r.a.createElement(Pe.a,{showHeader:!1,pagination:!1,rowKey:"_id",columns:this.columns,dataSource:this.state.members})),r.a.createElement(Nt,{visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,member:null,users:this.state.users,roles:Ft}))}}]),a}(n.Component),Pt=a(665),Vt=a(695);function Lt(e){var t=e.visible,a=e.onOk,n=e.onCancel,c=C.a.useForm(),o=Object(qe.a)(c,1)[0];return r.a.createElement(fe.a,{forceRender:!0,title:"\u65b0\u589e\u4efb\u52a1",width:640,visible:t,onOk:function(){o.validateFields().then((function(e){a(e),o.resetFields()})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{initialValues:{createDate:Ge()()},form:o,labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(C.a.Item,{name:"content",label:"\u4efb\u52a1\u5185\u5bb9",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u4efb\u52a1\u5185\u5bb9\uff01",min:5}]},r.a.createElement(I.a.TextArea,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),r.a.createElement(C.a.Item,{name:"createDate",label:"\u521b\u5efa\u65e5\u671f"},r.a.createElement(Ke.a,null))))}function At(e){var t=e.visible,a=e.onOk,c=e.onCancel,o=e.story,l=C.a.useForm(),s=Object(qe.a)(l,1)[0];return Object(n.useEffect)((function(){if(o){var e=Ge()(o.date);s.setFieldsValue(Object(h.a)(Object(h.a)({},o),{},{date:e}))}else s.resetFields()})),r.a.createElement(fe.a,{forceRender:!0,title:o?"\u7f16\u8f91\u9700\u6c42":"\u65b0\u589e\u9700\u6c42",width:640,visible:t,onOk:function(){s.validateFields().then((function(e){a(e)})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},onCancel:c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{initialValues:{date:Ge()(),priority:0},form:s,labelCol:{span:5},wrapperCol:{span:16}},r.a.createElement(C.a.Item,{name:"role",label:"\u89d2\u8272",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\uff01"}]},r.a.createElement(I.a,{placeholder:"\u8bf7\u8f93\u5165"})),r.a.createElement(C.a.Item,{name:"activity",label:"\u884c\u4e3a",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\uff01",min:5}]},r.a.createElement(I.a.TextArea,{rows:2,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),r.a.createElement(C.a.Item,{name:"businessValue",label:"\u76ee\u7684",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\uff01",min:5}]},r.a.createElement(I.a.TextArea,{rows:2,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})),r.a.createElement(C.a.Item,{name:"date",label:"\u63d0\u51fa\u65e5\u671f",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63d0\u51fa\u65e5\u671f\uff01"}]},r.a.createElement(Ke.a,null)),r.a.createElement(C.a.Item,{name:"priority",label:"\u4f18\u5148\u7ea7"},r.a.createElement(mt.a.Group,{name:"radiogroup"},r.a.createElement(mt.a,{value:0},"\u4f4e"),r.a.createElement(mt.a,{value:1},"\u4e2d"),r.a.createElement(mt.a,{value:2},"\u9ad8")))))}var qt=Pe.a.Column,Kt=[{color:"#2ac06d",display:"\u4f4e"},{color:"#f9944a",display:"\u4e2d"},{color:"#ff4d4f",display:"\u9ad8"}],Ut=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={storyModalVisible:!1,taskModalVisible:!1,current:null,storyList:[]},e.showStoryModal=function(t){e.setState({storyModalVisible:!0,current:t})},e.showTaskModal=function(t){e.setState({taskModalVisible:!0,current:t})},e.handleStoryCancel=function(t){e.setState({storyModalVisible:!1})},e.handleTaskCancel=function(t){e.setState({taskModalVisible:!1})},e.handleTaskOk=function(t){t.createDate=t.createDate.format("YYYY-MM-DD"),te(t).then((function(t){var a=t.data;if(0===a.code){var n=e.state.storyList.map((function(t){return t._id===e.state.current._id&&t.tasks.todo.push(a.data),t}));e.setState({storyList:n,taskModalVisible:!1})}}))},e.handleStoryOk=function(t){var a=e.state.current,n=a?a._id:"";t.date=t.date.format("YYYY-MM-DD"),n?ne(Object(h.a)(Object(h.a)({},t),{},{_id:n})).then((function(t){var a=t.data;if(0===a.code){var r=e.state.storyList.map((function(e){return e._id===n?Object(h.a)(Object(h.a)({},e),a.data):e}));e.setState({storyList:r,storyModalVisible:!1})}})):ae(t).then((function(t){var a=t.data;0===a.code&&e.setState({storyList:[a.data].concat(Object(v.a)(e.state.storyList)),storyModalVisible:!1})}))},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;J("/stories/list").then((function(t){var a=t.data;0===a.code&&(a.data.forEach((function(e){var t=e.tasks;e.tasks=It(t)})),e.setState({storyList:a.data}))}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.taskModalVisible,n=t.storyModalVisible,c=t.storyList,o=t.current;return r.a.createElement("div",null,r.a.createElement(Fe.a,{title:"\u9879\u76ee\u9700\u6c42",extra:r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.showStoryModal()}},r.a.createElement(Ye.a,{style:{fontSize:"24px"}}))},r.a.createElement(Pe.a,{dataSource:c,pagination:!1,rowKey:"_id",expandable:{expandedRowRender:function(e){var t=Object.values(e.tasks).flat();return r.a.createElement(St,{data:t,status:wt,size:"small",editable:!1})},rowExpandable:function(e){return Object.values(e.tasks).flat().length>0}}},r.a.createElement(qt,{width:"80px",title:"\u4f18\u5148\u7ea7",dataIndex:"priority",key:"priority",render:function(e){var t=Kt[e];return r.a.createElement(jt.a,{style:{width:"40px",textAlign:"center"},color:t.color},t.display)}}),r.a.createElement(qt,{title:"\u89d2\u8272",dataIndex:"role",key:"role"}),r.a.createElement(qt,{title:"\u884c\u4e3a",dataIndex:"activity",key:"activity"}),r.a.createElement(qt,{title:"\u76ee\u7684",dataIndex:"businessValue",key:"businessValue",progress:!0}),r.a.createElement(qt,{title:"\u4efb\u52a1\u8fdb\u5ea6",dataIndex:"_id",render:function(e,t){return r.a.createElement(s.b,{to:"/project/board/story/".concat(e)},r.a.createElement(nt,{todo:t.tasks.todo.length,doing:t.tasks.doing.length,done:t.tasks.done.length}))}}),r.a.createElement(qt,{title:"\u63d0\u51fa\u65e5\u671f",dataIndex:"date",key:"date"}),r.a.createElement(qt,{title:"\u64cd\u4f5c",key:"_id",render:function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{onClick:function(){return e.showStoryModal(a)}},r.a.createElement(Ve.a,null)),r.a.createElement(Pt.a,{type:"vertical"}),r.a.createElement("a",{onClick:function(){return e.showTaskModal(a)}},r.a.createElement(Vt.a,null)))}}))),r.a.createElement(Lt,{visible:a,onOk:this.handleTaskOk,onCancel:this.handleTaskCancel}),r.a.createElement(At,{visible:n,onOk:this.handleStoryOk,onCancel:this.handleStoryCancel,story:o}))}}]),a}(n.Component),Gt=a(696),zt=a(372),Jt=a(671);function Ht(e){var t=e.columns,a=e.visible,n=e.onCancel,c=e.onOk,o=Object(zt.a)(e,["columns","visible","onCancel","onOk"]);return r.a.createElement(fe.a,{forceRender:!0,title:"\u5bfc\u5165\u4efb\u52a1",width:1200,visible:a,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:c,onCancel:n},r.a.createElement(Jt.a,Object.assign({rowKey:function(e){return e._id}},o,{showSelectAll:!1}),(function(e){var a=e.filteredItems,n=e.onItemSelectAll,c=e.onItemSelect,o=e.selectedKeys,l={onSelectAll:function(e,t){var a=t.map((function(e){return e._id}));n(e?a:o,e)},onSelect:function(e,t){var a=e._id;c(a,t)},selectedRowKeys:o};return r.a.createElement(Pe.a,{pagination:!1,scroll:{y:300},rowSelection:l,rowKey:"_id",columns:t,dataSource:a,size:"small",onRow:function(e){var t=e._id;return{onClick:function(){c(t,!o.includes(t))}}}})})))}var Bt=function(e){return{type:"CREATE_SPRINT",data:e}},Qt=a(360),Wt=a.n(Qt),Xt=Ke.a.RangePicker,Zt=Pe.a.Column,$t=[{dataIndex:"content",title:"\u4efb\u52a1"},{dataIndex:"createDate",title:"\u521b\u5efa\u65f6\u95f4"}],ea=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1,transferVisible:!1,targetKeys:[],sprintList:[],tasks:[],currentId:null},e.onChange=function(t){e.setState({targetKeys:t})},e.showModal=function(){e.setState({visible:!0})},e.showTransferModal=function(t){e.setState({transferVisible:!0,targetKeys:[],currentId:t})},e.handleCancel=function(t){e.setState({visible:!1})},e.handleTransferCancel=function(t){e.setState({transferVisible:!1})},e.handleOk=function(t){e.form.validateFields().then((function(e){var t=e.rangeDate,a=t[0].format("YYYY-MM-DD"),n=t[1].format("YYYY-MM-DD");return ee({startDate:a,endDate:n})})).then((function(t){var a=t.data;if(0===a.code){var n=[].concat(Object(v.a)(e.state.sprintList),[a.data]);e.setState({visible:!1,sprintList:n}),e.form.resetFields()}})).catch((function(e){console.log("\u9a8c\u8bc1\u5931\u8d25\uff1a",e)}))},e.handleTransferOk=function(){var t=e.state,a=t.targetKeys,n=t.currentId;if(a.length){var r=[],c=[];e.state.tasks.forEach((function(e){a.includes(e._id)?r.push(e):c.push(e)}));var o=e.state.sprintList.map((function(e){return e._id===n?Object(h.a)(Object(h.a)({},e),{},{tasks:Object(h.a)(Object(h.a)({},e.tasks),{},{todo:e.tasks.todo.concat(r)})}):e}));e.setState({sprintList:o,tasks:c,transferVisible:!1})}else e.setState({transferVisible:!1})},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.getSprints(),$().then((function(t){var a=t.data;0===a.code&&(a.data.forEach((function(e){var t=e.tasks;e.tasks=It(t)})),e.setState({sprintList:a.data}))})),X().then((function(t){var a=t.data,n=a.data.filter((function(e){return"todo"===e.status}));0===a.code&&e.setState({tasks:n})}))}},{key:"render",value:function(){var e=this,t=this.props.project,a=t.startDate,n=t.endDate,c=this.state,o=c.targetKeys,l=c.tasks,i=c.transferVisible,u=c.sprintList,d=u.length,m=a;if(d>0){var p=u[d-1].endDate;m=Ge()(p).add(1,"days").format("YYYY-MM-DD")}return r.a.createElement("div",null,r.a.createElement(Fe.a,{title:"\u9879\u76ee\u9636\u6bb5",extra:r.a.createElement("a",{onClick:this.showModal},r.a.createElement(Ye.a,{style:{fontSize:"24px"}}))},r.a.createElement(Pe.a,{dataSource:u,pagination:!1,rowKey:"_id",rowClassName:function(e){return Ge()().isBetween(e.startDate,e.endDate,null,"[]")?Wt.a.curSprint:null},expandable:{expandedRowRender:function(e){var t=Object.values(e.tasks).flat();return r.a.createElement(St,{data:t,status:wt,size:"small",editable:!1})},rowExpandable:function(e){return Object.values(e.tasks).flat().length>0}}},r.a.createElement(Zt,{title:"\u9636\u6bb5\u5468\u671f",key:"date",render:function(e,t){return"".concat(t.startDate,"~").concat(t.endDate)}}),r.a.createElement(Zt,{title:"\u4efb\u52a1\u8fdb\u5ea6",dataIndex:"_id",render:function(e,t){return r.a.createElement(s.b,{to:"/project/board/sprint/".concat(e)},r.a.createElement(nt,{todo:t.tasks.todo.length,doing:t.tasks.doing.length,done:t.tasks.done.length}))}}),r.a.createElement(Zt,{title:"\u64cd\u4f5c",dataIndex:"_id",render:function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{onClick:function(){e.showTransferModal(t)}},r.a.createElement(Gt.a,null)))}}))),r.a.createElement(fe.a,{title:"\u65b0\u589e\u9636\u6bb5",width:480,visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement(C.a,{ref:function(t){return e.form=t}},r.a.createElement(C.a.Item,{name:"rangeDate",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9636\u6bb5\u65f6\u95f4\uff01"}]},r.a.createElement(Xt,{disabledDate:function(e){return!e.isBetween(m,n,"day","[]")},defaultPickerValue:[Ge()(m)],style:{width:"100%"}})))),r.a.createElement(Ht,{onCancel:this.handleTransferCancel,visible:i,dataSource:l,targetKeys:o,onOk:this.handleTransferOk,onChange:this.onChange,columns:$t}))}}]),a}(n.Component),ta={createSprint:function(e){return function(){var t=Object(L.a)(V.a.mark((function t(a){var n,r;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee(e);case 2:n=t.sent,0===(r=n.data).code&&a(Bt(r.data));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getSprints:function(){return function(){var e=Object(L.a)(V.a.mark((function e(t){var a,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$();case 2:a=e.sent,0===(n=a.data).code&&t({type:"RECEIVE_SPRINTS",data:n.data});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},aa=Object(l.b)((function(e){return{project:e.project,sprints:e.sprints}}),ta)(ea),na=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(){re()},e}return Object(O.a)(a,[{key:"render",value:function(){return r.a.createElement(_.a,{onClick:this.handleClick},"\u6d4b\u8bd5\u8bf7\u6c42\u62e6\u622a\uff08\u5168\u5c40\u6d88\u606f\uff09")}}]),a}(n.Component),ra=a(675),ca=function(){return r.a.createElement(ra.a,{status:"404",title:"404",style:{background:"none"},subTitle:"\u9875\u9762\u4e0d\u5b58\u5728"})},oa=pe.a.Content,la=function(e){Object(D.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={collapsed:!1},e.navList=[{path:"/",component:Xe,exact:!0},{path:"/project/profile",component:lt},{path:"/project/member",component:Yt},{path:"/project/meeting",component:it},{path:"/project/story",component:Ut},{path:"/project/board",component:_t,exact:!0},{path:"/project/board/:type/:id",component:_t},{path:"/project/sprint",component:aa},{path:"/test",component:na},{component:ca}],e.toggle=function(){e.setState({collapsed:!e.state.collapsed})},e.logout=function(){var t=Object(me.a)(e);fe.a.confirm({title:"\u786e\u8ba4\u9000\u51fa\u767b\u5f55\u5417\uff1f",icon:r.a.createElement(he.a,null),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",onOk:function(){N.a.remove("projectId"),N.a.remove("userId"),t.props.resetUser(),t.props.resetProject()}})},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){N.a.get("userId")&&!this.props.user._id&&this.props.getUser(),N.a.get("projectId")&&!this.props.project._id&&this.props.getProject()}},{key:"render",value:function(){var e=N.a.get("userId"),t=N.a.get("projectId"),a=!("/"===this.props.location.pathname&&!t);return e?a&&!t?r.a.createElement(i.a,{to:"/"}):r.a.createElement(pe.a,{style:{position:"fixed",top:0,left:0,right:0,bottom:0}},r.a.createElement(Se,{visiable:a,collapsed:this.state.collapsed}),r.a.createElement(pe.a,{style:{minHeight:"100vh"}},r.a.createElement(Ne,{visiable:a,projectName:this.props.project.projectName,username:this.props.user.username,collapsed:this.state.collapsed,toggle:a?this.toggle:null,logout:this.logout}),r.a.createElement(oa,{style:{padding:"24px",minHeight:"auto"}},r.a.createElement(i.d,null,this.navList.map((function(e,t){return r.a.createElement(i.b,Object.assign({key:t},e))})))))):r.a.createElement(i.a,{to:"/login"})}}]),a}(n.Component),sa={resetUser:le,resetProject:Be,getProject:function(){return function(){var e=Object(L.a)(V.a.mark((function e(t){var a,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J("/projects/project");case 2:a=e.sent,0===(n=a.data).code?t(He(n.data)):t(Be(n.msg));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},getUser:function(){return function(){var e=Object(L.a)(V.a.mark((function e(t){var a,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J("/users/user");case 2:a=e.sent,0===(n=a.data).code?t({type:"RECEIVE_USER",data:n.data}):t(le(n.msg));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},ia=Object(l.b)((function(e){return{user:e.user,project:e.project}}),sa)(la);a(660),a(661);o.a.render(r.a.createElement(u.a,{locale:d.a},r.a.createElement(l.a,{store:j},r.a.createElement(s.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login",component:ie}),r.a.createElement(i.b,{path:"/register",component:de}),r.a.createElement(i.b,{component:ia}))))),document.getElementById("root"))}},[[376,1,2]]]);
//# sourceMappingURL=main.23a90bb4.chunk.js.map